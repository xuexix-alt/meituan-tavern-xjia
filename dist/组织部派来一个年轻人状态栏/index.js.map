{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_53ff6257bd8fdf8315af10a81f7e3da1/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"Vue\"","webpack://tavern_helper_template/./src/ç»„ç»‡éƒ¨æ´¾æ¥ä¸€ä¸ªå¹´è½»äººçŠ¶æ€æ /App.vue?1901","webpack://tavern_helper_template/src/ç»„ç»‡éƒ¨æ´¾æ¥ä¸€ä¸ªå¹´è½»äººçŠ¶æ€æ /App.vue?6ee5","src://tavern_helper_template/src/ç»„ç»‡éƒ¨æ´¾æ¥ä¸€ä¸ªå¹´è½»äººçŠ¶æ€æ /index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, createTextVNode as _createTextVNode, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = [\"data-theme\"];\nconst _hoisted_2 = { class: \"header-section\" };\nconst _hoisted_3 = { class: \"info-layout\" };\nconst _hoisted_4 = { class: \"global-info-bar\" };\nconst _hoisted_5 = { class: \"info-item chapter\" };\nconst _hoisted_6 = { class: \"info-content\" };\nconst _hoisted_7 = { class: \"text\" };\nconst _hoisted_8 = { class: \"info-item time\" };\nconst _hoisted_9 = { class: \"info-content\" };\nconst _hoisted_10 = { class: \"text\" };\nconst _hoisted_11 = { class: \"info-item location\" };\nconst _hoisted_12 = { class: \"info-content\" };\nconst _hoisted_13 = { class: \"text\" };\nconst _hoisted_14 = { class: \"photo-section\" };\nconst _hoisted_15 = {\n    key: 0,\n    class: \"loading-spinner\"\n};\nconst _hoisted_16 = [\"src\", \"alt\"];\nconst _hoisted_17 = {\n    key: 2,\n    class: \"photo-placeholder\"\n};\nconst _hoisted_18 = {\n    key: 3,\n    class: \"photo-placeholder\"\n};\nconst _hoisted_19 = { class: \"photo-caption\" };\nconst _hoisted_20 = { class: \"char-name\" };\nconst _hoisted_21 = { class: \"content-section\" };\nconst _hoisted_22 = { class: \"info-grid\" };\nconst _hoisted_23 = { class: \"card full-width character-selector-card\" };\nconst _hoisted_24 = { class: \"tabs-nav\" };\nconst _hoisted_25 = [\"onClick\"];\nconst _hoisted_26 = {\n    key: 0,\n    class: \"card full-width thought-card\"\n};\nconst _hoisted_27 = { class: \"text-box thought\" };\nconst _hoisted_28 = {\n    key: 1,\n    class: \"card full-width action-card\"\n};\nconst _hoisted_29 = { class: \"text-box action\" };\nconst _hoisted_30 = { class: \"card info-card two-column-split\" };\nconst _hoisted_31 = { class: \"detail-list\" };\nconst _hoisted_32 = { class: \"label\" };\nconst _hoisted_33 = { class: \"value\" };\nconst _hoisted_34 = { class: \"card appearance-card two-column-split\" };\nconst _hoisted_35 = { class: \"appearance-list\" };\nconst _hoisted_36 = { class: \"appearance-label\" };\nconst _hoisted_37 = { class: \"appearance-text\" };\nconst _hoisted_38 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_39 = { key: 0 };\nconst _hoisted_40 = { key: 1 };\nconst _hoisted_41 = { key: 2 };\nconst _hoisted_42 = { key: 3 };\nconst _hoisted_43 = { class: \"modal-header\" };\nconst _hoisted_44 = { class: \"form-group\" };\nimport { ref, computed, onMounted, onUnmounted, watch, nextTick } from 'vue';\n// âœ… å¹¶è¡ŒåŠ è½½å›¾ç‰‡å‡½æ•°ï¼ˆæ”¹è¿›ç‰ˆï¼‰+ å¤šé•œåƒæ”¯æŒ\n// ä¸€æ¬¡æ€§å‘èµ·æ‰€æœ‰è¯·æ±‚ï¼Œå¤§å¹…æå‡åŠ è½½é€Ÿåº¦\n// âš ï¸ ä»…åŠ è½½ JPG æ ¼å¼ï¼Œé¿å…åŠ è½½ä½“ç§¯å·¨å¤§çš„ PNG\n// ğŸ’¡ ä½¿ç”¨ Cloudflare Pages æ‰˜ç®¡ï¼Œæ— ç¼“å­˜é—®é¢˜ï¼Œå›½å†…è®¿é—®å¿«\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const loadImagesParallel = async (roleName) => {\n            // CDN é•œåƒåˆ—è¡¨ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åˆ—ï¼‰\n            const cdnMirrors = [\n                'https://meituan-tavern-xjia.pages.dev/image', // Cloudflare Pagesï¼ˆæ¨èï¼Œæ— ç¼“å­˜ï¼‰\n                'https://fastly.jsdelivr.net/gh/xuexix-alt/meituan-tavern-xjia/image', // jsdelivr Fastly é•œåƒï¼ˆå¤‡é€‰1ï¼‰\n                'https://gcore.jsdelivr.net/gh/xuexix-alt/meituan-tavern-xjia/image', // jsdelivr Gcore é•œåƒï¼ˆå¤‡é€‰2ï¼‰\n            ];\n            const maxAttempts = 5; // å°è¯•å‰5ä¸ªæ•°å­—åç¼€\n            let lastError = null;\n            // éå†æ‰€æœ‰ CDN é•œåƒï¼Œç›´åˆ°æ‰¾åˆ°å¯ç”¨çš„\n            for (const cdnPrefix of cdnMirrors) {\n                try {\n                    console.log(`[å›¾ç‰‡] ğŸ”„ å°è¯•ä½¿ç”¨é•œåƒ: ${cdnPrefix}`);\n                    const imageUrls = [];\n                    // åŸºç¡€æ–‡ä»¶åï¼ˆæ— æ•°å­—åç¼€ï¼‰- ä»…åŠ è½½ JPG\n                    imageUrls.push({\n                        url: `${cdnPrefix}/${encodeURIComponent(roleName)}.jpg`,\n                        name: `${roleName}.jpg`,\n                    });\n                    // å¸¦æ•°å­—åç¼€çš„æ–‡ä»¶ - ä»…åŠ è½½ JPG\n                    for (let i = 1; i <= maxAttempts; i++) {\n                        imageUrls.push({\n                            url: `${cdnPrefix}/${encodeURIComponent(roleName)}${i}.jpg`,\n                            name: `${roleName}${i}.jpg`,\n                        });\n                    }\n                    console.log(`[å›¾ç‰‡] ğŸ” å¼€å§‹å¹¶è¡ŒåŠ è½½ \"${roleName}\" çš„æ‰€æœ‰ JPG å›¾ç‰‡ (å…± ${imageUrls.length} ä¸ª URL)...`);\n                    // å¹¶è¡Œå‘èµ·æ‰€æœ‰è¯·æ±‚\n                    const results = await Promise.allSettled(imageUrls.map(({ url, name }) => loadImageAsBlob(url, name)));\n                    // ç­›é€‰æˆåŠŸçš„å›¾ç‰‡\n                    const blobUrls = [];\n                    results.forEach((result, index) => {\n                        if (result.status === 'fulfilled' && result.value) {\n                            blobUrls.push(result.value);\n                            console.log(`[å›¾ç‰‡] âœ… æˆåŠŸåŠ è½½: ${imageUrls[index].name}`);\n                        }\n                    });\n                    console.log(`[å›¾ç‰‡] ğŸ“Š å…±æ‰¾åˆ° ${blobUrls.length} å¼  JPG å›¾ç‰‡`);\n                    if (blobUrls.length > 0) {\n                        console.log(`[å›¾ç‰‡] âœ… ä½¿ç”¨é•œåƒ \"${cdnPrefix}\" åŠ è½½æˆåŠŸ`);\n                        return blobUrls;\n                    }\n                }\n                catch (error) {\n                    lastError = error;\n                    console.warn(`[å›¾ç‰‡] âš ï¸ é•œåƒå¤±è´¥: ${cdnPrefix}`, lastError.message);\n                    // ç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªé•œåƒ\n                    continue;\n                }\n            }\n            // æ‰€æœ‰é•œåƒéƒ½å¤±è´¥\n            console.error(`[å›¾ç‰‡] âŒ æ‰€æœ‰ CDN é•œåƒéƒ½æ— æ³•åŠ è½½ \"${roleName}\"`, lastError);\n            return [];\n        };\n        // ä» URL åŠ è½½å•ä¸ªå›¾ç‰‡ä¸º Blob URL\n        const loadImageAsBlob = (url, fileName) => {\n            return new Promise((resolve) => {\n                // ä½¿ç”¨ fetch åŠ è½½å›¾ç‰‡ï¼Œé¿å… Canvas è½¬æ¢çš„æ€§èƒ½å¼€é”€\n                fetch(url, { mode: 'cors' })\n                    .then((response) => {\n                    if (!response.ok) {\n                        throw new Error(`HTTP ${response.status}`);\n                    }\n                    return response.blob();\n                })\n                    .then((blob) => {\n                    // åˆ›å»º Blob URLï¼Œæ¯” Base64 å¿«å¾—å¤š\n                    const blobUrl = URL.createObjectURL(blob);\n                    console.log(`[å›¾ç‰‡] âœ… æˆåŠŸåŠ è½½å¹¶è½¬æ¢: ${fileName} (${(blob.size / 1024).toFixed(2)} KB)`);\n                    resolve(blobUrl);\n                })\n                    .catch((error) => {\n                    console.warn(`[å›¾ç‰‡] âŒ åŠ è½½å¤±è´¥: ${fileName}`, error.message);\n                    resolve(null);\n                });\n            });\n        };\n        // âœ… IndexedDB åˆå§‹åŒ–\n        const initImageDatabase = async () => {\n            try {\n                return new Promise((resolve, reject) => {\n                    const request = indexedDB.open('TavernImageCache', 1);\n                    request.onerror = () => {\n                        console.warn('[æ•°æ®åº“] âŒ IndexedDB æ‰“å¼€å¤±è´¥');\n                        reject(request.error);\n                    };\n                    request.onsuccess = () => {\n                        const db = request.result;\n                        console.log('[æ•°æ®åº“] âœ… IndexedDB å·²åˆå§‹åŒ–');\n                        resolve(db);\n                    };\n                    request.onupgradeneeded = (event) => {\n                        const db = event.target.result;\n                        if (!db.objectStoreNames.contains('images')) {\n                            db.createObjectStore('images', { keyPath: 'roleName' });\n                            console.log('[æ•°æ®åº“] ğŸ“¦ åˆ›å»º images å¯¹è±¡å­˜å‚¨');\n                        }\n                    };\n                });\n            }\n            catch (e) {\n                console.warn('[æ•°æ®åº“] âŒ åˆå§‹åŒ–å¤±è´¥:', e);\n                return null;\n            }\n        };\n        let imageDatabase = null;\n        // âœ… ä» IndexedDB è·å–å›¾ç‰‡äºŒè¿›åˆ¶æ•°æ®\n        const getImageFromDB = async (roleName) => {\n            try {\n                if (!imageDatabase) {\n                    imageDatabase = await initImageDatabase();\n                    if (!imageDatabase)\n                        return null;\n                }\n                return new Promise((resolve) => {\n                    const transaction = imageDatabase.transaction(['images'], 'readonly');\n                    const store = transaction.objectStore('images');\n                    const request = store.get(roleName);\n                    request.onsuccess = () => {\n                        if (request.result && request.result.blob) {\n                            console.log(`[æ•°æ®åº“] âœ… ä» IndexedDB è·å– \"${roleName}\" çš„å›¾ç‰‡`);\n                            resolve(request.result.blob);\n                        }\n                        else {\n                            resolve(null);\n                        }\n                    };\n                    request.onerror = () => {\n                        console.warn(`[æ•°æ®åº“] âŒ æŸ¥è¯¢å¤±è´¥: ${roleName}`);\n                        resolve(null);\n                    };\n                });\n            }\n            catch (e) {\n                console.warn('[æ•°æ®åº“] âŒ è·å–å¤±è´¥:', e);\n                return null;\n            }\n        };\n        // âœ… ä¿å­˜å›¾ç‰‡åˆ° IndexedDB\n        const saveImageToDB = async (roleName, blob) => {\n            try {\n                if (!imageDatabase) {\n                    imageDatabase = await initImageDatabase();\n                    if (!imageDatabase)\n                        return false;\n                }\n                return new Promise((resolve) => {\n                    const transaction = imageDatabase.transaction(['images'], 'readwrite');\n                    const store = transaction.objectStore('images');\n                    const request = store.put({ roleName, blob });\n                    request.onsuccess = () => {\n                        console.log(`[æ•°æ®åº“] ğŸ’¾ å·²ä¿å­˜ \"${roleName}\" åˆ° IndexedDB`);\n                        resolve(true);\n                    };\n                    request.onerror = () => {\n                        console.warn(`[æ•°æ®åº“] âŒ ä¿å­˜å¤±è´¥: ${roleName}`);\n                        resolve(false);\n                    };\n                });\n            }\n            catch (e) {\n                console.warn('[æ•°æ®åº“] âŒ ä¿å­˜å¤±è´¥:', e);\n                return false;\n            }\n        };\n        // âœ… æ”¹è¿›çš„å›¾ç‰‡ç¼“å­˜è·å–å‡½æ•°ï¼ˆæ·»åŠ  IndexedDB + å¤šé•œåƒæ”¯æŒï¼‰\n        const getImageFromCache = async (roleName) => {\n            try {\n                // 1. é¦–å…ˆå°è¯•ä» IndexedDB è·å–\n                const cachedBlob = await getImageFromDB(roleName);\n                if (cachedBlob) {\n                    const blobUrl = URL.createObjectURL(cachedBlob);\n                    console.log(`[å›¾ç‰‡] âœ… ä½¿ç”¨ IndexedDB ç¼“å­˜ï¼ˆæ— éœ€é‡æ–°åŠ è½½ï¼‰`);\n                    return blobUrl;\n                }\n                console.log(`[å›¾ç‰‡] ğŸ“¡ ç¼“å­˜æœªå‘½ä¸­ï¼Œæ­£åœ¨åŠ è½½ \"${roleName}\" çš„å›¾ç‰‡...ï¼ˆä½¿ç”¨å¹¶è¡ŒåŠ è½½ï¼Œé€Ÿåº¦æ›´å¿«ï¼‰`);\n                // 2. ä½¿ç”¨å¹¶è¡ŒåŠ è½½è·å–æ‰€æœ‰å¯ç”¨å›¾ç‰‡\n                const blobUrls = await loadImagesParallel(roleName);\n                if (blobUrls.length === 0) {\n                    console.log(`[å›¾ç‰‡] âŒ \"${roleName}\" æ²¡æœ‰æ‰¾åˆ°ä»»ä½•å›¾ç‰‡æ–‡ä»¶`);\n                    return null;\n                }\n                // 3. éšæœºé€‰æ‹©ä¸€å¼ å›¾ç‰‡\n                const randomIndex = Math.floor(Math.random() * blobUrls.length);\n                const selectedImageUrl = blobUrls[randomIndex];\n                console.log(`[å›¾ç‰‡] ğŸ² ä¸º \"${roleName}\" éšæœºé€‰æ‹©ç¬¬ ${randomIndex + 1} å¼ å›¾ç‰‡ï¼ˆå…± ${blobUrls.length} å¼ ï¼‰`);\n                // 4. å¼‚æ­¥ä¿å­˜åˆ° IndexedDBï¼ˆä¸é˜»å¡ UIï¼‰\n                fetch(selectedImageUrl)\n                    .then(r => r.blob())\n                    .then(blob => saveImageToDB(roleName, blob))\n                    .catch(e => console.warn('[æ•°æ®åº“] åå°ä¿å­˜å¤±è´¥:', e));\n                // 5. æ¸…ç†å…¶ä»–æœªä½¿ç”¨çš„ Blob URLï¼ˆé˜²æ­¢å†…å­˜æ³„æ¼ï¼‰\n                blobUrls.forEach((url, index) => {\n                    if (index !== randomIndex) {\n                        URL.revokeObjectURL(url);\n                    }\n                });\n                return selectedImageUrl;\n            }\n            catch (e) {\n                console.warn(`[å›¾ç‰‡] è·å–å›¾ç‰‡å¤±è´¥:`, e);\n                return null;\n            }\n        };\n        // --- çŠ¶æ€ç®¡ç† ---\n        const containerRef = ref(null);\n        const statData = ref({\n            ç« èŠ‚: 'ç¤ºä¾‹ç« èŠ‚',\n            æ—¶é—´: 'ç¤ºä¾‹æ—¶é—´',\n            å½“å‰åœ°ç‚¹: 'ç¤ºä¾‹åœ°ç‚¹',\n            è§’è‰²: {\n                é™†å‰¯å‚é•¿: {\n                    å¹´é¾„: 25,\n                    èº«ä»½: 'ç¤ºä¾‹èº«ä»½',\n                    ä¸userå…³ç³»: 'ç¤ºä¾‹å…³ç³»',\n                    æ‰€å¤„ä½ç½®: 'ç¤ºä¾‹ä½ç½®',\n                    å½“å‰æƒ³æ³•: 'ç¤ºä¾‹æƒ³æ³•ï¼šè¯·åœ¨é…’é¦†ä¸­å®‰è£…é…’é¦†åŠ©æ‰‹æ‰©å±•ä»¥è·å–å®æ—¶æ•°æ®',\n                    å§¿åŠ¿: 'ç¤ºä¾‹å§¿åŠ¿',\n                    è¡£ç€: 'ç¤ºä¾‹è¡£ç€',\n                    èƒ¸ä¹³: 'ç¤ºä¾‹èƒ¸ä¹³',\n                    å†…è¡£: 'ç¤ºä¾‹å†…è¡£',\n                    ç§å¤„: 'ç¤ºä¾‹ç§å¤„',\n                    é‹è¢œ: 'ç¤ºä¾‹é‹è¢œ',\n                    ç…§ç‰‡: 'image/é™†å‰¯å‚é•¿',\n                },\n            },\n        });\n        const activeChar = ref(''); // åˆå§‹ä¸ºç©ºï¼Œç­‰å¾…åˆå§‹åŒ–\n        const showThemeModal = ref(false);\n        const currentTheme = ref(localStorage.getItem('tavern_helper_theme') || 'default');\n        const isImageLoading = ref(false);\n        // --- è®¡ç®—å±æ€§ ---\n        const characterNames = computed(() => Object.keys(statData.value.è§’è‰² || {}));\n        const hasCharacters = computed(() => characterNames.value.length > 0);\n        // âœ… å›¾ç‰‡åŠ è½½çŠ¶æ€\n        const imagesLoaded = computed(() => {\n            // æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜çš„å›¾ç‰‡\n            const currentIndex = characterNames.value.indexOf(activeChar.value);\n            if (currentIndex === -1)\n                return false;\n            const imageKey = mapRoleToImageName(activeChar.value, currentIndex);\n            const cacheKey = `image_cache_${imageKey}`;\n            return sessionStorage.getItem(cacheKey) !== null;\n        });\n        // âœ… é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªè§’è‰²ï¼ˆ{{user}}ï¼‰\n        const defaultActiveChar = computed(() => {\n            return characterNames.value.length > 0 ? characterNames.value[0] : '';\n        });\n        // âœ… è§’è‰²ååˆ—è¡¨ï¼ˆç”¨äºæ˜¾ç¤ºï¼Œç›´æ¥ä½¿ç”¨é…’é¦†è§£æåçš„åŸåï¼‰\n        // ä¾‹å¦‚ï¼š[\"å°å“¥å“¥\", \"è‹æ™´\", \"ä¸å°èŠ¹\"] - å›¾ç‰‡æ–‡ä»¶åä¸è§’è‰²åä¸€è‡´\n        const cleanedCharacterNames = computed(() => {\n            return characterNames.value.map(name => cleanCharName(name));\n        });\n        const activeCharData = computed(() => {\n            if (!activeChar.value)\n                return null;\n            // âœ… ä»å½“å‰é€‰ä¸­çš„è§’è‰²åè·å–æ•°æ®ï¼ˆ{{user}} å·²è¢«é…’é¦†æ›¿æ¢ä¸ºå®é™…ç”¨æˆ·åï¼‰\n            const data = statData.value.è§’è‰²?.[activeChar.value];\n            console.log(`[æ•°æ®] ä»\"${activeChar.value}\"è·å–æ•°æ®`);\n            return data || null;\n        });\n        // âœ… ç®€åŒ–ç‰ˆæ¸…ç†è§’è‰²åå‡½æ•°ï¼ˆä»…ç”¨äºå®‰å…¨æ£€æŸ¥ï¼‰\n        const cleanCharName = (name) => {\n            if (!name)\n                return '';\n            // åªåšåŸºæœ¬çš„å®‰å…¨æ£€æŸ¥å’Œç©ºæ ¼æ¸…ç†\n            return name.trim();\n        };\n        // âœ… å°†è§’è‰²åæ˜ å°„åˆ°å›¾ç‰‡å\n        // æ³¨æ„ï¼šç¬¬ä¸€ä¸ªè§’è‰²æ— è®ºç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Œéƒ½ä½¿ç”¨\"é™†å‰¯å‚é•¿\"çš„å›¾ç‰‡\n        const mapRoleToImageName = (roleName, roleIndex) => {\n            // ç¬¬ä¸€ä¸ªè§’è‰²ï¼ˆç´¢å¼•0ï¼‰æ°¸è¿œæ˜ å°„ä¸º\"é™†å‰¯å‚é•¿\"ï¼ˆç©å®¶è§’è‰²{{user}}ï¼‰\n            // ä¸ç®¡ç”¨æˆ·åæ˜¯\"å°å“¥å“¥\"ã€\"å¼ ä¸‰\"è¿˜æ˜¯å…¶ä»–ï¼Œéƒ½ä½¿ç”¨\"é™†å‰¯å‚é•¿\"å›¾ç‰‡\n            if (roleIndex === 0) {\n                return 'é™†å‰¯å‚é•¿';\n            }\n            // âœ… å…¶ä»–è§’è‰²ç›´æ¥ä½¿ç”¨è§’è‰²åä½œä¸ºå›¾ç‰‡å\n            // è‹æ™´ â†’ è‹æ™´\n            // ä¸å°èŠ¹ â†’ ä¸å°èŠ¹\n            // æ—å©‰ä»ª â†’ æ—å©‰ä»ª\n            // ç‹æ˜¥ç‡• â†’ ç‹æ˜¥ç‡•\n            // ç™½æ…§ â†’ ç™½æ…§\n            return cleanCharName(roleName);\n        };\n        // âœ… å›¾ç‰‡ç¼“å­˜å·²ç”±ç‹¬ç«‹çš„è„šæœ¬ç®¡ç†å™¨å¤„ç†\n        // å‰ç«¯ç•Œé¢ç›´æ¥ä»å…¨å±€ç¼“å­˜è·å–å›¾ç‰‡\n        // âœ… å½“å‰æ˜¾ç¤ºçš„å›¾ç‰‡URLï¼ˆå“åº”å¼ï¼‰\n        const currentPhotoUrl = ref('');\n        // âœ… é¢„åŠ è½½ç¼“å­˜ï¼ˆåå°é¢„åŠ è½½ä¸‹ä¸€ä¸ªè§’è‰²çš„å›¾ç‰‡ï¼Œæ¶ˆé™¤åˆ‡æ¢å»¶è¿Ÿï¼‰\n        const preloadCache = ref(new Map());\n        /**\n         * åå°é¢„åŠ è½½æŒ‡å®šè§’è‰²çš„å›¾ç‰‡\n         * ä¸ä¼šé˜»å¡ UIï¼Œç”¨æˆ·åˆ‡æ¢æ—¶å¯ä»¥ç«‹å³æ˜¾ç¤º\n         */\n        const preloadNextCharacter = async (nextCharName) => {\n            if (!nextCharName)\n                return;\n            // å¦‚æœå·²ç»åœ¨ç¼“å­˜ä¸­ï¼Œè·³è¿‡\n            if (preloadCache.value.has(nextCharName)) {\n                console.log(`[é¢„åŠ è½½] â­ï¸ \"${nextCharName}\" å·²åœ¨é¢„åŠ è½½ç¼“å­˜ä¸­ï¼Œè·³è¿‡`);\n                return;\n            }\n            // å¦‚æœå·²ç»åœ¨ sessionStorage ä¸­ï¼Œè·³è¿‡\n            const cacheKey = `image_cache_${nextCharName}`;\n            if (sessionStorage.getItem(cacheKey)) {\n                console.log(`[é¢„åŠ è½½] â­ï¸ \"${nextCharName}\" å·²åœ¨ sessionStorage ä¸­ï¼Œè·³è¿‡`);\n                return;\n            }\n            console.log(`[é¢„åŠ è½½] ğŸš€ åå°é¢„åŠ è½½ \"${nextCharName}\" çš„å›¾ç‰‡...`);\n            try {\n                // ä½¿ç”¨ loadImagesParallel å¹¶è¡ŒåŠ è½½æ‰€æœ‰å›¾ç‰‡\n                const blobUrls = await loadImagesParallel(nextCharName);\n                if (blobUrls.length === 0) {\n                    console.log(`[é¢„åŠ è½½] âŒ \"${nextCharName}\" æ²¡æœ‰å¯ç”¨çš„å›¾ç‰‡`);\n                    return;\n                }\n                // éšæœºé€‰æ‹©ä¸€å¼ å›¾ç‰‡\n                const randomIndex = Math.floor(Math.random() * blobUrls.length);\n                const selectedImage = blobUrls[randomIndex];\n                // å­˜å‚¨åˆ°é¢„åŠ è½½ç¼“å­˜\n                preloadCache.value.set(nextCharName, selectedImage);\n                console.log(`[é¢„åŠ è½½] âœ… \"${nextCharName}\" é¢„åŠ è½½å®Œæˆ (é€‰æ‹©ç¬¬ ${randomIndex + 1} å¼ ï¼Œå…± ${blobUrls.length} å¼ )`);\n                // æ¸…ç†å…¶ä»–æœªä½¿ç”¨çš„ Blob URL\n                blobUrls.forEach((url, index) => {\n                    if (index !== randomIndex) {\n                        URL.revokeObjectURL(url);\n                    }\n                });\n            }\n            catch (e) {\n                console.warn(`[é¢„åŠ è½½] âŒ é¢„åŠ è½½ \"${nextCharName}\" å¤±è´¥:`, e);\n            }\n        };\n        /**\n         * åŠ è½½å½“å‰è§’è‰²çš„å›¾ç‰‡\n         * ä¼˜å…ˆä½¿ç”¨é¢„åŠ è½½ç¼“å­˜ï¼Œå…¶æ¬¡ä½¿ç”¨ sessionStorage ç¼“å­˜\n         */\n        const loadCurrentPhoto = async () => {\n            // âœ… è·å–å½“å‰è§’è‰²åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•\n            const currentIndex = characterNames.value.indexOf(activeChar.value);\n            if (currentIndex === -1) {\n                console.log(`[ç…§ç‰‡] å½“å‰è§’è‰²\"${activeChar.value}\"ä¸åœ¨è§’è‰²åˆ—è¡¨ä¸­`);\n                currentPhotoUrl.value = '';\n                return;\n            }\n            // âœ… è·å–è§’è‰²åï¼ˆä½œä¸ºå›¾ç‰‡æ–‡ä»¶åï¼‰\n            // {{user}} å·²è¢«é…’é¦†æ›¿æ¢ä¸ºå®é™…ç”¨æˆ·åï¼Œå¦‚\"å°å“¥å“¥\"\n            const imageKey = mapRoleToImageName(activeChar.value, currentIndex);\n            console.log(`[ç…§ç‰‡] è§’è‰²ç´¢å¼•: ${currentIndex}, è§’è‰²å: \"${activeChar.value}\", å›¾ç‰‡å: \"${imageKey}\"`);\n            // âœ… ä¼˜å…ˆæŸ¥è¯¢é¢„åŠ è½½ç¼“å­˜\n            if (preloadCache.value.has(imageKey)) {\n                const preloadedUrl = preloadCache.value.get(imageKey);\n                currentPhotoUrl.value = preloadedUrl || '';\n                console.log(`[ç…§ç‰‡] ${imageKey}: ä»é¢„åŠ è½½ç¼“å­˜åŠ è½½ âš¡`);\n                // åŠ è½½å®Œæˆåé¢„åŠ è½½ä¸‹ä¸€ä¸ªè§’è‰²\n                const nextIndex = (currentIndex + 1) % characterNames.value.length;\n                const nextCharName = characterNames.value[nextIndex];\n                const nextImageKey = mapRoleToImageName(nextCharName, nextIndex);\n                preloadNextCharacter(nextImageKey);\n                return;\n            }\n            // âœ… ä»ç‹¬ç«‹ç¼“å­˜ä¸­è·å–å›¾ç‰‡\n            const imageUrl = await getImageFromCache(imageKey);\n            if (imageUrl) {\n                currentPhotoUrl.value = imageUrl;\n                console.log(`[ç…§ç‰‡] ${imageKey}: åŠ è½½æˆåŠŸ`);\n                // åŠ è½½å®Œæˆåé¢„åŠ è½½ä¸‹ä¸€ä¸ªè§’è‰²\n                const nextIndex = (currentIndex + 1) % characterNames.value.length;\n                const nextCharName = characterNames.value[nextIndex];\n                const nextImageKey = mapRoleToImageName(nextCharName, nextIndex);\n                preloadNextCharacter(nextImageKey);\n            }\n            else {\n                currentPhotoUrl.value = '';\n                console.log(`[ç…§ç‰‡] ${imageKey}: æš‚æ— å›¾ç‰‡ï¼Œæš‚ä¸æ˜¾ç¤º`);\n            }\n        };\n        // åŸºç¡€ä¿¡æ¯æ˜ å°„\n        const basicInfo = computed(() => ({\n            'ğŸ‚ å¹´é¾„': activeCharData.value?.å¹´é¾„,\n            'ğŸ’¼ èº«ä»½': activeCharData.value?.èº«ä»½,\n            'ğŸ¤ å…³ç³»': activeCharData.value?.ä¸userå…³ç³»,\n            'ğŸ“ ä½ç½®': activeCharData.value?.æ‰€å¤„ä½ç½®,\n        }));\n        // å¤–è§‚ä¿¡æ¯æ˜ å°„\n        const appearanceInfo = computed(() => ({\n            'ğŸ‘” è¡£ç€': activeCharData.value?.è¡£ç€,\n            'ğŸŒ¸ èƒ¸ä¹³': activeCharData.value?.èƒ¸ä¹³,\n            'ğŸ‘™ å†…è¡£': activeCharData.value?.å†…è¡£,\n            'ğŸ”’ ç§å¤„': activeCharData.value?.ç§å¤„,\n            'ğŸ‘  é‹è¢œ': activeCharData.value?.é‹è¢œ,\n        }));\n        // --- æ ¸å¿ƒé€»è¾‘ ---\n        /**\n         * æ ¸å¿ƒæ•°æ®è·å–å‡½æ•°\n         * å…¼å®¹å¤šç§ APIï¼šgetCurrentMessageId / getLastMessageId\n         */\n        const fetchData = async () => {\n            try {\n                // æ£€æŸ¥é…’é¦†åŠ©æ‰‹æ¥å£æ˜¯å¦å¯ç”¨\n                const hasGetCurrent = typeof getCurrentMessageId === 'function';\n                const hasGetLast = typeof getLastMessageId === 'function';\n                const hasGetMsgs = typeof getChatMessages === 'function';\n                if (!hasGetMsgs) {\n                    console.warn('[é…’é¦†åŠ©æ‰‹] æ¥å£æœªåŠ è½½');\n                    return;\n                }\n                let targetMsg = null;\n                // å°è¯•å¤šç§æ–¹å¼è·å–æœ€æ–°æ¶ˆæ¯\n                if (hasGetCurrent) {\n                    // æ–¹å¼ 1: getCurrentMessageId (å¸¸è§äºæ—§ç‰ˆæœ¬)\n                    const msgId = getCurrentMessageId();\n                    if (msgId) {\n                        const msgs = getChatMessages(msgId);\n                        targetMsg = msgs && msgs.length > 0 ? msgs[0] : null;\n                    }\n                }\n                else if (hasGetLast) {\n                    // æ–¹å¼ 2: getLastMessageId (å¸¸è§äºæ–°ç‰ˆæœ¬)\n                    const lastId = getLastMessageId();\n                    if (lastId) {\n                        const msgs = getChatMessages(lastId);\n                        targetMsg = msgs && msgs.length > 0 ? msgs[0] : null;\n                    }\n                }\n                if (targetMsg?.data?.stat_data) {\n                    console.log('[é…’é¦†åŠ©æ‰‹] æˆåŠŸè·å–æ•°æ®');\n                    statData.value = targetMsg.data.stat_data;\n                    // ç­‰å¾… characterNames è®¡ç®—å±æ€§æ›´æ–°åå†æ£€æŸ¥\n                    await nextTick();\n                    // å¦‚æœå½“å‰æ²¡æœ‰é€‰ä¸­è§’è‰²ï¼Œä¸”æœ‰è§’è‰²æ•°æ®ï¼Œé»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª\n                    if (!activeChar.value && characterNames.value.length > 0) {\n                        console.log(`[é»˜è®¤] è‡ªåŠ¨é€‰ä¸­ç¬¬ä¸€ä¸ªè§’è‰²: \"${characterNames.value[0]}\"`);\n                        activeChar.value = characterNames.value[0];\n                    }\n                    // æ•°æ®æ›´æ–°åè°ƒæ•´é«˜åº¦ï¼ˆå»¶è¿Ÿç­‰å¾… DOM æ›´æ–°ï¼‰\n                    await nextTick();\n                    adjustHeight();\n                }\n            }\n            catch (e) {\n                console.warn('æ•°æ®åŒæ­¥å¤±è´¥:', e);\n            }\n        };\n        const handleManualRefresh = () => {\n            fetchData();\n            isImageLoading.value = true;\n            // æ¨¡æ‹ŸåŠ è½½åŠ¨ç”»\n            const btn = document.querySelector('.refresh-btn');\n            btn?.classList.add('spinning');\n            setTimeout(() => {\n                btn?.classList.remove('spinning');\n                isImageLoading.value = false;\n            }, 1000);\n        };\n        const switchCharacter = async (name) => {\n            console.log(`[åˆ‡æ¢] ğŸ’« åˆ‡æ¢è§’è‰²: \"${name}\"`);\n            // è®¾ç½®åŠ è½½çŠ¶æ€\n            isImageLoading.value = true;\n            try {\n                activeChar.value = name;\n                // è·å–æ–°è§’è‰²çš„ç´¢å¼•ï¼Œç”¨äºæ˜ å°„å›¾ç‰‡æ–‡ä»¶å\n                const newIndex = characterNames.value.indexOf(name);\n                const imageKey = mapRoleToImageName(name, newIndex);\n                // æ£€æŸ¥é¢„åŠ è½½ç¼“å­˜ï¼Œå¦‚æœå·²é¢„åŠ è½½åˆ™ç›´æ¥ä½¿ç”¨\n                if (preloadCache.value.has(imageKey)) {\n                    const preloadedUrl = preloadCache.value.get(imageKey);\n                    currentPhotoUrl.value = preloadedUrl || '';\n                    console.log(`[åˆ‡æ¢] âš¡ ä½¿ç”¨é¢„åŠ è½½çš„å›¾ç‰‡ï¼Œé›¶å»¶è¿Ÿåˆ‡æ¢å®Œæˆ`);\n                    isImageLoading.value = false;\n                    // é¢„åŠ è½½ä¸‹ä¸€ä¸ªè§’è‰²\n                    const nextIndex = (newIndex + 1) % characterNames.value.length;\n                    const nextCharName = characterNames.value[nextIndex];\n                    const nextImageKey = mapRoleToImageName(nextCharName, nextIndex);\n                    preloadNextCharacter(nextImageKey);\n                    return;\n                }\n                // å¦‚æœæ²¡æœ‰é¢„åŠ è½½ï¼Œåˆ™åŠ è½½æ–°è§’è‰²çš„å›¾ç‰‡\n                await loadCurrentPhoto();\n                console.log(`[åˆ‡æ¢] âœ… åˆ‡æ¢å®Œæˆ: \"${name}\"`);\n            }\n            catch (e) {\n                console.error(`[åˆ‡æ¢] âŒ åˆ‡æ¢å¤±è´¥:`, e);\n            }\n            finally {\n                isImageLoading.value = false;\n                // åˆ‡æ¢è§’è‰²åè°ƒæ•´é«˜åº¦\n                nextTick(adjustHeight);\n            }\n        };\n        const handleImageLoad = () => {\n            isImageLoading.value = false;\n            console.log('[ç…§ç‰‡] âœ… å›¾ç‰‡åŠ è½½æˆåŠŸå¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸­');\n            // å›¾ç‰‡åŠ è½½å®Œå¯èƒ½å½±å“é«˜åº¦\n            nextTick(() => setTimeout(adjustHeight, 100));\n        };\n        const handleImageError = (e) => {\n            isImageLoading.value = false;\n            const img = e.target;\n            console.warn('[ç…§ç‰‡] âš ï¸ é¡µé¢å›¾ç‰‡åŠ è½½å¤±è´¥ï¼ˆä½†ç¼“å­˜ä¸­å­˜åœ¨è¯¥å›¾ç‰‡URLï¼‰:', {\n                src: img.src.substring(0, 50) + '...',\n                reason: 'Blob URL å¯èƒ½å·²è¢«é‡Šæ”¾æˆ–æµè§ˆå™¨ç¯å¢ƒå˜åŒ–',\n            });\n            // å°è¯•é‡æ–°åŠ è½½å½“å‰è§’è‰²çš„å›¾ç‰‡ï¼ˆè¿™æ¬¡ä¼šè·³è¿‡é¢„åŠ è½½ç¼“å­˜ï¼Œä»æºå¤´é‡æ–°åŠ è½½ï¼‰\n            console.log('[ç…§ç‰‡] ğŸ”„ å°è¯•é‡æ–°åŠ è½½å›¾ç‰‡...');\n            loadCurrentPhoto().catch((err) => {\n                console.error('[ç…§ç‰‡] âŒ é‡æ–°åŠ è½½å¤±è´¥:', err);\n            });\n        };\n        const toggleThemeModal = () => {\n            showThemeModal.value = !showThemeModal.value;\n        };\n        const handlePhotoClick = () => {\n            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ç‚¹å‡»ç…§ç‰‡çš„äº¤äº’é€»è¾‘ï¼Œå¦‚ï¼š\n            // - åˆ‡æ¢åˆ°ä¸‹ä¸€å¼ å›¾ç‰‡\n            // - æ‰“å¼€å¤§å›¾é¢„è§ˆ\n            // - é‡æ–°éšæœºé€‰æ‹©å›¾ç‰‡\n            // ç›®å‰æš‚ä¸å®ç°å…·ä½“åŠŸèƒ½\n        };\n        // --- é«˜åº¦è‡ªé€‚åº”é€»è¾‘ (ä¼˜åŒ–ç‰ˆ) ---\n        const adjustHeight = () => {\n            if (!containerRef.value)\n                return;\n            // ä½¿ç”¨ requestAnimationFrame é¿å…å¸ƒå±€æŠ–åŠ¨\n            requestAnimationFrame(() => {\n                const height = containerRef.value?.scrollHeight || 300;\n                const finalHeight = Math.max(height, 300) + 20; // å¢åŠ ä¸€ç‚¹ç¼“å†²\n                // å‘é€æ¶ˆæ¯ç»™çˆ¶çº§ (é…’é¦†æ‰©å±•æ ‡å‡†åšæ³•)\n                if (window.parent && window.parent !== window) {\n                    window.parent.postMessage({\n                        type: 'adjustIframeHeight',\n                        height: finalHeight,\n                        scriptId: 'status-bar',\n                    }, '*');\n                }\n            });\n        };\n        // ç›‘å¬å™¨\n        let resizeObserver = null;\n        onMounted(async () => {\n            // 1. åˆå§‹åŒ–æ•°æ®\n            fetchData();\n            // 2. æ³¨å†Œäº‹ä»¶ç›‘å¬ (ä½¿ç”¨è§„èŒƒçš„ eventOn)\n            if (typeof eventOn === 'function' && typeof tavern_events !== 'undefined') {\n                // ç›‘å¬æ¶ˆæ¯æ›´æ–°å’Œæ¥æ”¶\n                eventOn(tavern_events.MESSAGE_UPDATED, fetchData);\n                eventOn(tavern_events.MESSAGE_RECEIVED, fetchData);\n                eventOn(tavern_events.CHAT_CHANGED, fetchData);\n            }\n            // 3. å¯åŠ¨é«˜åº¦ç›‘å¬\n            if (containerRef.value && typeof ResizeObserver !== 'undefined') {\n                resizeObserver = new ResizeObserver(() => adjustHeight());\n                resizeObserver.observe(containerRef.value);\n                resizeObserver.observe(document.body); // åŒæ—¶ä¹Ÿç›‘å¬ body å˜åŒ–\n            }\n            // 4. æ¢å¤ä¸»é¢˜\n            document.documentElement.setAttribute('data-theme', currentTheme.value);\n            // 5. ç­‰å¾…æ•°æ®åŠ è½½å®Œæˆåï¼ŒåŠ è½½å›¾ç‰‡\n            const unwatch = watch(() => statData.value.è§’è‰², async (newRoles) => {\n                if (newRoles && Object.keys(newRoles).length > 0) {\n                    // ç­‰å¾…è§’è‰²è‡ªåŠ¨é€‰ä¸­å®Œæˆåå†åŠ è½½å›¾ç‰‡\n                    if (activeChar.value) {\n                        await loadCurrentPhoto();\n                        unwatch(); // åªæ‰§è¡Œä¸€æ¬¡\n                    }\n                }\n            }, { immediate: true });\n            // åŒæ—¶ç›‘å¬ activeChar çš„å˜åŒ–ï¼Œä¸€æ—¦è®¾ç½®å°±åŠ è½½å›¾ç‰‡\n            const unwatchChar = watch(activeChar, async (newChar) => {\n                if (newChar && characterNames.value.length > 0) {\n                    await loadCurrentPhoto();\n                    unwatchChar(); // åªæ‰§è¡Œä¸€æ¬¡\n                }\n            });\n        });\n        onUnmounted(() => {\n            if (resizeObserver)\n                resizeObserver.disconnect();\n            // âœ… æ¸…ç†é¢„åŠ è½½ç¼“å­˜ä¸­çš„ Blob URLï¼Œé˜²æ­¢å†…å­˜æ³„æ¼\n            preloadCache.value.forEach((blobUrl) => {\n                URL.revokeObjectURL(blobUrl);\n            });\n            preloadCache.value.clear();\n            // âœ… å…³é—­ IndexedDB è¿æ¥\n            if (imageDatabase) {\n                imageDatabase.close();\n                console.log('[æ¸…ç†] å·²å…³é—­ IndexedDB è¿æ¥');\n            }\n            console.log('[æ¸…ç†] å·²é‡Šæ”¾é¢„åŠ è½½ç¼“å­˜ä¸­çš„æ‰€æœ‰ Blob URL');\n        });\n        watch(activeChar, () => {\n            nextTick(adjustHeight);\n        });\n        watch(currentTheme, val => {\n            localStorage.setItem('tavern_helper_theme', val);\n            document.documentElement.setAttribute('data-theme', val);\n            nextTick(adjustHeight);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"main\", {\n                class: \"glass-container\",\n                \"data-theme\": currentTheme.value,\n                ref_key: \"containerRef\",\n                ref: containerRef\n            }, [\n                _createCommentVNode(\" é¡¶éƒ¨åŠŸèƒ½åŒº \"),\n                _createElementVNode(\"header\", _hoisted_2, [\n                    _createElementVNode(\"div\", { class: \"header-content\" }, [\n                        _cache[6] || (_cache[6] = _createElementVNode(\"h2\", { class: \"section-title\" }, [\n                            _createElementVNode(\"span\", { class: \"icon-pulse\" }, \"ğŸ“Š\"),\n                            _createElementVNode(\"span\", { class: \"title-text\" }, \"çŠ¶æ€ç›‘è§†å™¨\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", { class: \"header-actions\" }, [\n                            _createElementVNode(\"button\", {\n                                class: \"icon-btn refresh-btn\",\n                                onClick: handleManualRefresh,\n                                title: \"å¼ºåˆ¶åˆ·æ–°æ•°æ®\"\n                            }, [...(_cache[4] || (_cache[4] = [\n                                    _createElementVNode(\"span\", null, \"ğŸ”„\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"icon-btn theme-toggle\",\n                                onClick: toggleThemeModal,\n                                title: \"æ˜¾ç¤ºè®¾ç½®\"\n                            }, [...(_cache[5] || (_cache[5] = [\n                                    _createElementVNode(\"span\", { class: \"gear-icon\" }, \"âš™ï¸\", -1 /* CACHED */)\n                                ]))])\n                        ])\n                    ]),\n                    _createCommentVNode(\" åŸºç¡€ä¿¡æ¯å¡ç‰‡ \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _cache[8] || (_cache[8] = _createElementVNode(\"span\", { class: \"icon\" }, \"ğŸ“–\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_6, [\n                                    _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"label\" }, \"å½“å‰ç« èŠ‚\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(statData.value.ç« èŠ‚ || 'ç­‰å¾…æ•°æ®...'), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_8, [\n                                _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"icon\" }, \"ğŸ•\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"label\" }, \"ä¸–ç•Œæ—¶é—´\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(statData.value.æ—¶é—´ || 'æœªçŸ¥æ—¶é—´'), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_11, [\n                                _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"icon\" }, \"ğŸ“\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_12, [\n                                    _cache[11] || (_cache[11] = _createElementVNode(\"span\", { class: \"label\" }, \"å½“å‰åœ°ç‚¹\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_13, _toDisplayString(statData.value.å½“å‰åœ°ç‚¹ || 'æœªçŸ¥åœ°ç‚¹'), 1 /* TEXT */)\n                                ])\n                            ])\n                        ]),\n                        _createCommentVNode(\" è§’è‰²ç…§ç‰‡åŒº \"),\n                        _createElementVNode(\"div\", _hoisted_14, [\n                            _createElementVNode(\"div\", {\n                                class: _normalizeClass([\"photo-frame\", {\n                                        'has-photo': currentPhotoUrl.value && imagesLoaded.value,\n                                        loading: isImageLoading.value || !imagesLoaded.value,\n                                    }]),\n                                onClick: handlePhotoClick\n                            }, [\n                                (isImageLoading.value || !imagesLoaded.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15))\n                                    : _createCommentVNode(\"v-if\", true),\n                                (currentPhotoUrl.value)\n                                    ? (_openBlock(), _createElementBlock(\"img\", {\n                                        key: 1,\n                                        src: currentPhotoUrl.value,\n                                        alt: activeChar.value,\n                                        class: \"char-photo\",\n                                        onError: handleImageError,\n                                        onLoad: handleImageLoad\n                                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_16))\n                                    : (imagesLoaded.value)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [...(_cache[13] || (_cache[13] = [\n                                                _createElementVNode(\"span\", { class: \"placeholder-icon\" }, \"ğŸ‘¤\", -1 /* CACHED */),\n                                                _createElementVNode(\"span\", { class: \"placeholder-text\" }, \"NO IMAGE\", -1 /* CACHED */)\n                                            ]))]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [...(_cache[14] || (_cache[14] = [\n                                                _createElementVNode(\"span\", { class: \"placeholder-icon\" }, \"â³\", -1 /* CACHED */),\n                                                _createElementVNode(\"span\", { class: \"placeholder-text\" }, \"LOADING...\", -1 /* CACHED */)\n                                            ]))]))\n                            ], 2 /* CLASS */),\n                            _createElementVNode(\"div\", _hoisted_19, [\n                                _createElementVNode(\"span\", _hoisted_20, _toDisplayString(cleanCharName(activeChar.value || 'æœªçŸ¥è§’è‰²')), 1 /* TEXT */),\n                                _createElementVNode(\"span\", {\n                                    class: _normalizeClass([\"char-status-dot\", { active: hasCharacters.value }])\n                                }, null, 2 /* CLASS */)\n                            ])\n                        ])\n                    ])\n                ]),\n                _createCommentVNode(\" è§’è‰²è¯¦æƒ…åŒº \"),\n                _createElementVNode(\"section\", _hoisted_21, [\n                    _createCommentVNode(\" è¯¦æƒ…å†…å®¹ \"),\n                    _createVNode(_Transition, {\n                        name: \"fade-slide\",\n                        mode: \"out-in\"\n                    }, {\n                        default: _withCtx(() => [\n                            (activeCharData.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", {\n                                    key: activeChar.value,\n                                    class: \"tab-content\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_22, [\n                                        _createCommentVNode(\" äººç‰©é€‰æ‹©å¡ç‰‡ - å…¨å®½ \"),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _cache[15] || (_cache[15] = _createElementVNode(\"h3\", null, \"ğŸ‘¥ äººç‰©é€‰æ‹©\", -1 /* CACHED */)),\n                                            _createElementVNode(\"nav\", _hoisted_24, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(cleanedCharacterNames.value, (cleanName, index) => {\n                                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                                        key: characterNames.value[index],\n                                                        class: _normalizeClass([\"tab-button\", { active: characterNames.value[index] === activeChar.value }]),\n                                                        onClick: ($event) => (switchCharacter(characterNames.value[index]))\n                                                    }, [\n                                                        _createTextVNode(_toDisplayString(cleanName) + \" \", 1 /* TEXT */),\n                                                        _createCommentVNode(\" âœ… æ˜¾ç¤ºæ¸…ç†åçš„åå­— \")\n                                                    ], 10 /* CLASS, PROPS */, _hoisted_25));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ]),\n                                        _createCommentVNode(\" å¿ƒç†ä¸å§¿æ€ (å…¨å®½) \"),\n                                        (activeCharData.value.å½“å‰æƒ³æ³•)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_26, [\n                                                _cache[16] || (_cache[16] = _createElementVNode(\"h3\", null, \"ğŸ’­ å†…å¿ƒæƒ³æ³•\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_27, _toDisplayString(activeCharData.value.å½“å‰æƒ³æ³•), 1 /* TEXT */)\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (activeCharData.value.å§¿åŠ¿)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [\n                                                _cache[17] || (_cache[17] = _createElementVNode(\"h3\", null, \"ğŸƒ å½“å‰å§¿æ€\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_29, _toDisplayString(activeCharData.value.å§¿åŠ¿), 1 /* TEXT */)\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createCommentVNode(\" åŸºç¡€å±æ€§ \"),\n                                        _createElementVNode(\"div\", _hoisted_30, [\n                                            _cache[18] || (_cache[18] = _createElementVNode(\"h3\", null, \"ğŸ“‹ çŠ¶æ€é¢æ¿\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_31, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(basicInfo.value, (val, key) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        class: \"detail-item\",\n                                                        key: key\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_32, _toDisplayString(key.replace(/^[^\\u4e00-\\u9fa5]+/, '')), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_33, _toDisplayString(val || '--'), 1 /* TEXT */)\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ]),\n                                        _createCommentVNode(\" å¤–è§‚ç‰¹å¾ \"),\n                                        _createElementVNode(\"div\", _hoisted_34, [\n                                            _cache[19] || (_cache[19] = _createElementVNode(\"h3\", null, \"ğŸ‘¤ å¤–è§‚ç‰¹å¾\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_35, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(appearanceInfo.value, (val, key) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        class: \"appearance-item\",\n                                                        key: key\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_36, _toDisplayString(key.replace(/^[^\\u4e00-\\u9fa5]+/, '')), 1 /* TEXT */),\n                                                        _createElementVNode(\"div\", _hoisted_37, _toDisplayString(val || '--'), 1 /* TEXT */)\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ])\n                                    ])\n                                ]))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_38, [\n                                    _cache[20] || (_cache[20] = _createElementVNode(\"div\", { class: \"empty-icon\" }, \"ğŸ“¡\", -1 /* CACHED */)),\n                                    (!imagesLoaded.value)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_39, \"åŠ è½½ä¸­...\"))\n                                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_40, \"è¯·é€‰æ‹©ä¸€ä¸ªè§’è‰²\")),\n                                    (!imagesLoaded.value)\n                                        ? (_openBlock(), _createElementBlock(\"small\", _hoisted_41, \"æ­£åœ¨åŒæ­¥é…’é¦†æ•°æ®\"))\n                                        : (_openBlock(), _createElementBlock(\"small\", _hoisted_42, \"ç‚¹å‡»ä¸Šæ–¹é€‰é¡¹å¡æŸ¥çœ‹è§’è‰²ä¿¡æ¯\"))\n                                ]))\n                        ]),\n                        _: 1 /* STABLE */\n                    })\n                ]),\n                _createCommentVNode(\" è®¾ç½®å¼¹çª— \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (showThemeModal.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"modal-overlay\",\n                                onClick: _cache[3] || (_cache[3] = ($event) => (showThemeModal.value = false))\n                            }, [\n                                _createElementVNode(\"div\", {\n                                    class: \"modal-content glass-panel\",\n                                    onClick: _cache[2] || (_cache[2] = _withModifiers(() => { }, [\"stop\"]))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_43, [\n                                        _cache[21] || (_cache[21] = _createElementVNode(\"h3\", null, \"ç•Œé¢è®¾ç½®\", -1 /* CACHED */)),\n                                        _createElementVNode(\"button\", {\n                                            class: \"btn-close\",\n                                            onClick: _cache[0] || (_cache[0] = ($event) => (showThemeModal.value = false))\n                                        }, \"Ã—\")\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_44, [\n                                        _cache[23] || (_cache[23] = _createElementVNode(\"label\", null, \"ğŸ¨ ä¸»é¢˜é£æ ¼\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((currentTheme).value = $event))\n                                        }, [...(_cache[22] || (_cache[22] = [\n                                                _createElementVNode(\"option\", { value: \"default\" }, \"âœ¨ æå…‰ç»ç’ƒ (é»˜è®¤)\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"dark\" }, \"ğŸŒ‘ æ·±ç©ºå¹½è“\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"classic_vintage\" }, \"ğŸ“œ ç¾Šçš®å·è½´\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, currentTheme.value]\n                                        ])\n                                    ])\n                                ])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ], 8 /* PROPS */, _hoisted_1));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=00b738b6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_53ff6257bd8fdf8315af10a81f7e3da1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-00b738b6\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport App from './App.vue';\nimport './index.scss';\n\n$(() => {\n  const mountPoint = document.getElementById('app');\n\n  // âœ… é˜²é‡å¤æŒ‚è½½ï¼šæ£€æŸ¥æ˜¯å¦å·²ç»åŠ è½½è¿‡çŠ¶æ€æ \n  if (sessionStorage.getItem('status_bar_loaded')) {\n    console.log('[çŠ¶æ€æ ] å·²å­˜åœ¨ï¼Œè·³è¿‡é‡å¤åŠ è½½');\n    return;\n  }\n\n  if (mountPoint) {\n    const app = createApp(App);\n    app.mount(mountPoint);\n\n    // âœ… æ ‡è®°ä¸ºå·²åŠ è½½\n    sessionStorage.setItem('status_bar_loaded', 'true');\n\n    console.log('LingDong: Vue App Mounted Successfully.');\n\n    // ä¸¥æ ¼éµå¾ªè§„èŒƒï¼šä½¿ç”¨ pagehide æ¸…ç†èµ„æº\n    $(window).on('pagehide', () => {\n      app.unmount();\n      console.log('LingDong: Vue App Unmounted.');\n      // âœ… æ¸…ç†æ ‡è®°\n      sessionStorage.removeItem('status_bar_loaded');\n    });\n  } else {\n    console.error('LingDong: Mount point #app not found!');\n  }\n});\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","Vue","_hoisted_1","_hoisted_2","class","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","__name","setup","__props","loadImagesParallel","async","roleName","cdnMirrors","lastError","cdnPrefix","console","log","imageUrls","push","url","encodeURIComponent","name","i","length","results","Promise","allSettled","map","loadImageAsBlob","blobUrls","forEach","result","index","status","value","error","warn","message","fileName","resolve","fetch","mode","then","response","ok","Error","blob","blobUrl","URL","createObjectURL","size","toFixed","catch","initImageDatabase","reject","request","indexedDB","open","onerror","onsuccess","db","onupgradeneeded","event","objectStoreNames","contains","createObjectStore","keyPath","e","imageDatabase","getImageFromCache","cachedBlob","transaction","objectStore","get","getImageFromDB","randomIndex","Math","floor","random","selectedImageUrl","r","put","saveImageToDB","revokeObjectURL","containerRef","ref","statData","activeChar","showThemeModal","currentTheme","localStorage","getItem","isImageLoading","characterNames","computed","Object","keys","hasCharacters","imagesLoaded","currentIndex","indexOf","cacheKey","mapRoleToImageName","sessionStorage","cleanedCharacterNames","cleanCharName","activeCharData","data","trim","roleIndex","currentPhotoUrl","preloadCache","Map","preloadNextCharacter","nextCharName","has","selectedImage","set","loadCurrentPhoto","imageKey","preloadedUrl","nextIndex","nextImageKey","imageUrl","basicInfo","appearanceInfo","fetchData","hasGetCurrent","getCurrentMessageId","hasGetLast","getLastMessageId","getChatMessages","targetMsg","msgId","msgs","lastId","stat_data","nextTick","adjustHeight","handleManualRefresh","btn","document","querySelector","classList","add","setTimeout","remove","handleImageLoad","handleImageError","img","src","substring","reason","err","toggleThemeModal","handlePhotoClick","requestAnimationFrame","height","scrollHeight","finalHeight","max","window","parent","postMessage","type","scriptId","resizeObserver","onMounted","eventOn","tavern_events","MESSAGE_UPDATED","MESSAGE_RECEIVED","CHAT_CHANGED","ResizeObserver","observe","body","documentElement","setAttribute","unwatch","watch","newRoles","immediate","unwatchChar","newChar","onUnmounted","disconnect","clear","close","setItem","_ctx","_cache","ref_key","onClick","title","loading","alt","onError","onLoad","active","default","cleanName","$event","newIndex","replace","_","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","$","mountPoint","getElementById","app","createApp","App","mount","on","unmount","removeItem"],"ignoreList":[],"sourceRoot":""}