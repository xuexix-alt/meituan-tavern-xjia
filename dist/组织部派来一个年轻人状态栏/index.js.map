{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"Vue\"","webpack://tavern_helper_template/./src/ç»„ç»‡éƒ¨æ´¾æ¥ä¸€ä¸ªå¹´è½»äººçŠ¶æ€æ /App.vue?1901","webpack://tavern_helper_template/src/ç»„ç»‡éƒ¨æ´¾æ¥ä¸€ä¸ªå¹´è½»äººçŠ¶æ€æ /App.vue?f260","src://tavern_helper_template/src/ç»„ç»‡éƒ¨æ´¾æ¥ä¸€ä¸ªå¹´è½»äººçŠ¶æ€æ /index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, createTextVNode as _createTextVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = [\"data-theme\"];\nconst _hoisted_2 = { class: \"header-section\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"progress-bar-container\"\n};\nconst _hoisted_4 = { class: \"progress-info\" };\nconst _hoisted_5 = { class: \"progress-text\" };\nconst _hoisted_6 = { class: \"progress-count\" };\nconst _hoisted_7 = { class: \"progress-bar\" };\nconst _hoisted_8 = { class: \"info-layout\" };\nconst _hoisted_9 = { class: \"global-info-bar\" };\nconst _hoisted_10 = { class: \"info-item chapter\" };\nconst _hoisted_11 = { class: \"info-content\" };\nconst _hoisted_12 = { class: \"text\" };\nconst _hoisted_13 = { class: \"info-item time\" };\nconst _hoisted_14 = { class: \"info-content\" };\nconst _hoisted_15 = { class: \"text\" };\nconst _hoisted_16 = { class: \"info-item location\" };\nconst _hoisted_17 = { class: \"info-content\" };\nconst _hoisted_18 = { class: \"text\" };\nconst _hoisted_19 = { class: \"photo-section\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"loading-spinner\"\n};\nconst _hoisted_21 = [\"src\", \"alt\"];\nconst _hoisted_22 = {\n    key: 2,\n    class: \"photo-placeholder\"\n};\nconst _hoisted_23 = {\n    key: 3,\n    class: \"photo-placeholder\"\n};\nconst _hoisted_24 = { class: \"photo-caption\" };\nconst _hoisted_25 = { class: \"char-name\" };\nconst _hoisted_26 = [\"title\"];\nconst _hoisted_27 = { class: \"content-section\" };\nconst _hoisted_28 = { class: \"info-grid\" };\nconst _hoisted_29 = { class: \"card full-width character-selector-card\" };\nconst _hoisted_30 = { class: \"tabs-nav\" };\nconst _hoisted_31 = [\"onClick\"];\nconst _hoisted_32 = {\n    key: 0,\n    class: \"card full-width thought-card\"\n};\nconst _hoisted_33 = { class: \"text-box thought\" };\nconst _hoisted_34 = {\n    key: 1,\n    class: \"card full-width action-card\"\n};\nconst _hoisted_35 = { class: \"text-box action\" };\nconst _hoisted_36 = { class: \"card info-card two-column-split\" };\nconst _hoisted_37 = { class: \"detail-list\" };\nconst _hoisted_38 = { class: \"label\" };\nconst _hoisted_39 = { class: \"value\" };\nconst _hoisted_40 = { class: \"card appearance-card two-column-split\" };\nconst _hoisted_41 = { class: \"appearance-list\" };\nconst _hoisted_42 = { class: \"appearance-label\" };\nconst _hoisted_43 = { class: \"appearance-text\" };\nconst _hoisted_44 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_45 = { key: 0 };\nconst _hoisted_46 = { key: 1 };\nconst _hoisted_47 = { key: 2 };\nconst _hoisted_48 = { key: 3 };\nconst _hoisted_49 = { class: \"modal-header\" };\nconst _hoisted_50 = { class: \"form-group\" };\nimport { ref, computed, onMounted, onUnmounted, watch, nextTick } from 'vue';\n// è½»é‡çº§å›¾ç‰‡åŠ è½½ï¼šå°æ‰¹æ¬¡é¡ºåºæ¢æµ‹ + å†…å­˜ç¼“å­˜ï¼Œèˆå¼ƒ IndexedDB ä¸å¤§è§„æ¨¡å¹¶è¡Œ\nconst MAX_CANDIDATES = 3; // å•è§’è‰²æœ€å¤šå°è¯• 3 å¼ ï¼Œå…¼é¡¾åˆ‡æ¢ä½“éªŒä¸æµé‡\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const cdnMirrors = [\n            'https://testingcf.jsdelivr.net/gh/xuexix-alt/meituan-tavern-xjia/image',\n            'https://gcore.jsdelivr.net/gh/xuexix-alt/meituan-tavern-xjia/image',\n        ];\n        const buildImageUrls = (imageKey, limit = MAX_CANDIDATES) => {\n            const urls = [];\n            for (let idx = 0; idx < limit; idx++) {\n                const suffix = idx === 0 ? '' : `${idx}`;\n                for (const mirror of cdnMirrors) {\n                    urls.push(`${mirror}/${encodeURIComponent(imageKey)}${suffix}.jpg`);\n                }\n            }\n            return urls;\n        };\n        const probeImage = (url) => new Promise(resolve => {\n            const img = new Image();\n            img.onload = () => resolve(true);\n            img.onerror = () => resolve(false);\n            img.src = url;\n        });\n        const imageCache = ref(new Map());\n        const fetchAvailableImages = async (imageKey, need = 1) => {\n            const cached = imageCache.value.get(imageKey);\n            if (cached && cached.length >= need)\n                return cached.slice(0, need);\n            const candidates = buildImageUrls(imageKey, MAX_CANDIDATES);\n            const found = [];\n            for (const url of candidates) {\n                if (found.length >= need)\n                    break;\n                const ok = await probeImage(url);\n                if (ok) {\n                    found.push(url);\n                    if (isPreloading.value)\n                        loadingProgress.value += 1;\n                }\n            }\n            if (found.length) {\n                imageCache.value.set(imageKey, found);\n            }\n            return found;\n        };\n        // --- çŠ¶æ€ç®¡ç† ---\n        // --- çŠ¶æ€ç®¡ç† ---\n        // --- çŠ¶æ€ç®¡ç† ---\n        const containerRef = ref(null);\n        const statData = ref({\n            ç« èŠ‚: 'ç¤ºä¾‹ç« èŠ‚',\n            æ—¶é—´: 'ç¤ºä¾‹æ—¶é—´',\n            å½“å‰åœ°ç‚¹: 'ç¤ºä¾‹åœ°ç‚¹',\n            è§’è‰²: {\n                é™†å‰¯å‚é•¿: {\n                    å¹´é¾„: 25,\n                    èº«ä»½: 'ç¤ºä¾‹èº«ä»½',\n                    ä¸userå…³ç³»: 'ç¤ºä¾‹å…³ç³»',\n                    æ‰€å¤„ä½ç½®: 'ç¤ºä¾‹ä½ç½®',\n                    å½“å‰æƒ³æ³•: 'ç¤ºä¾‹æƒ³æ³•ï¼šè¯·åœ¨é…’é¦†ä¸­å®‰è£…é…’é¦†åŠ©æ‰‹æ‰©å±•ä»¥è·å–å®æ—¶æ•°æ®',\n                    å§¿åŠ¿: 'ç¤ºä¾‹å§¿åŠ¿',\n                    è¡£ç€: 'ç¤ºä¾‹è¡£ç€',\n                    èƒ¸ä¹³: 'ç¤ºä¾‹èƒ¸ä¹³',\n                    å†…è¡£: 'ç¤ºä¾‹å†…è¡£',\n                    ç§å¤„: 'ç¤ºä¾‹ç§å¤„',\n                    é‹è¢œ: 'ç¤ºä¾‹é‹è¢œ',\n                    ç…§ç‰‡: 'image/é™†å‰¯å‚é•¿',\n                },\n            },\n        });\n        const activeChar = ref(''); // åˆå§‹ä¸ºç©ºï¼Œç­‰å¾…åˆå§‹åŒ–\n        const showThemeModal = ref(false);\n        const currentTheme = ref(localStorage.getItem('tavern_helper_theme') || 'default');\n        const isImageLoading = ref(false);\n        // âœ… å›¾ç‰‡é¢„åŠ è½½è¿›åº¦è·Ÿè¸ª\n        const loadingProgress = ref(0); // å½“å‰å·²åŠ è½½æ•°é‡\n        const totalImages = ref(1); // æ€»å›¾ç‰‡æ•°é‡ï¼ˆé¢„ä¼°ï¼‰\n        const isPreloading = ref(false); // æ˜¯å¦æ­£åœ¨é¢„åŠ è½½\n        const preloadPhase = ref(''); // å½“å‰åŠ è½½é˜¶æ®µæè¿°\n        // --- è®¡ç®—å±æ€§ ---\n        const characterNames = computed(() => Object.keys(statData.value.è§’è‰² || {}));\n        const hasCharacters = computed(() => characterNames.value.length > 0);\n        // âœ… å½“å‰è§’è‰²çš„å›¾ç‰‡ä¿¡æ¯\n        const currentImageInfo = computed(() => {\n            if (!activeChar.value)\n                return null;\n            const currentIndex = characterNames.value.indexOf(activeChar.value);\n            if (currentIndex === -1)\n                return null;\n            const imageKey = mapRoleToImageName(activeChar.value, currentIndex);\n            const images = preloadCache.value.get(imageKey);\n            const currentIdx = imageIndexMap.value.get(imageKey) || 0;\n            return {\n                imageKey,\n                images: images || [],\n                currentIndex: currentIdx,\n                total: images?.length || 0,\n                hasMultiple: (images?.length || 0) > 1,\n            };\n        });\n        // âœ… åˆå§‹åŒ–å®Œæˆæ ‡å¿—ï¼ˆæ˜¯å¦å·²å°è¯•åŠ è½½è¿‡å›¾ç‰‡ï¼‰\n        const initializationComplete = ref(false);\n        // âœ… å›¾ç‰‡åŠ è½½å®ŒæˆçŠ¶æ€ï¼ˆç®€åŒ–é€»è¾‘ï¼šåŸºäºæ˜¯å¦æœ‰ currentPhotoUrlï¼‰\n        const imagesLoaded = computed(() => {\n            // å¦‚æœåˆå§‹åŒ–è¿˜æœªå®Œæˆï¼Œè¿”å› falseï¼ˆæ˜¾ç¤ºåŠ è½½ä¸­ï¼‰\n            if (!initializationComplete.value)\n                return false;\n            // å¦‚æœæœ‰ currentPhotoUrlï¼Œè¯´æ˜åŠ è½½æˆåŠŸ\n            if (currentPhotoUrl.value)\n                return true;\n            // å¦åˆ™è¿”å› trueï¼ˆåˆå§‹åŒ–å®Œæˆä½†æ²¡æœ‰å›¾ç‰‡ï¼Œæ˜¾ç¤ºå ä½ç¬¦ï¼‰\n            return true;\n        });\n        // âœ… è§’è‰²ååˆ—è¡¨ï¼ˆç”¨äºæ˜¾ç¤ºï¼Œç›´æ¥ä½¿ç”¨é…’é¦†è§£æåçš„åŸåï¼‰\n        // ä¾‹å¦‚ï¼š[\"å°å“¥å“¥\", \"è‹æ™´\", \"ä¸å°èŠ¹\"] - å›¾ç‰‡æ–‡ä»¶åä¸è§’è‰²åä¸€è‡´\n        const cleanedCharacterNames = computed(() => {\n            return characterNames.value.map(name => cleanCharName(name));\n        });\n        const activeCharData = computed(() => {\n            if (!activeChar.value)\n                return null;\n            // âœ… ä»å½“å‰é€‰ä¸­çš„è§’è‰²åè·å–æ•°æ®ï¼ˆ{{user}} å·²è¢«é…’é¦†æ›¿æ¢ä¸ºå®é™…ç”¨æˆ·åï¼‰\n            const data = statData.value.è§’è‰²?.[activeChar.value];\n            console.log(`[æ•°æ®] ä»\"${activeChar.value}\"è·å–æ•°æ®`);\n            return data || null;\n        });\n        // âœ… ç®€åŒ–ç‰ˆæ¸…ç†è§’è‰²åå‡½æ•°ï¼ˆä»…ç”¨äºå®‰å…¨æ£€æŸ¥ï¼‰\n        const cleanCharName = (name) => {\n            if (!name)\n                return '';\n            // åªåšåŸºæœ¬çš„å®‰å…¨æ£€æŸ¥å’Œç©ºæ ¼æ¸…ç†\n            return name.trim();\n        };\n        // âœ… å°†è§’è‰²åæ˜ å°„åˆ°å›¾ç‰‡å\n        // æ³¨æ„ï¼šç¬¬ä¸€ä¸ªè§’è‰²æ— è®ºç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Œéƒ½ä½¿ç”¨\"é™†å‰¯å‚é•¿\"çš„å›¾ç‰‡\n        const mapRoleToImageName = (roleName, roleIndex) => {\n            // ç¬¬ä¸€ä¸ªè§’è‰²ï¼ˆç´¢å¼•0ï¼‰æ°¸è¿œæ˜ å°„ä¸º\"é™†å‰¯å‚é•¿\"ï¼ˆç©å®¶è§’è‰²{{user}}ï¼‰\n            // ä¸ç®¡ç”¨æˆ·åæ˜¯\"å°å“¥å“¥\"ã€\"å¼ ä¸‰\"è¿˜æ˜¯å…¶ä»–ï¼Œéƒ½ä½¿ç”¨\"é™†å‰¯å‚é•¿\"å›¾ç‰‡\n            if (roleIndex === 0) {\n                return 'é™†å‰¯å‚é•¿';\n            }\n            // âœ… å…¶ä»–è§’è‰²ç›´æ¥ä½¿ç”¨è§’è‰²åä½œä¸ºå›¾ç‰‡å\n            // è‹æ™´ â†’ è‹æ™´\n            // ä¸å°èŠ¹ â†’ ä¸å°èŠ¹\n            // æ—å©‰ä»ª â†’ æ—å©‰ä»ª\n            // ç‹æ˜¥ç‡• â†’ ç‹æ˜¥ç‡•\n            // ç™½æ…§ â†’ ç™½æ…§\n            return cleanCharName(roleName);\n        };\n        // âœ… å›¾ç‰‡ç¼“å­˜å·²ç”±ç‹¬ç«‹çš„è„šæœ¬ç®¡ç†å™¨å¤„ç†\n        // å‰ç«¯ç•Œé¢ç›´æ¥ä»å…¨å±€ç¼“å­˜è·å–å›¾ç‰‡\n        // ? å½“å‰æ˜¾ç¤ºçš„å›¾ç‰‡URLï¼ˆå“åº”å¼ï¼‰\n        const currentPhotoUrl = ref('');\n        const preloadCache = imageCache; // å¤ç”¨è½»é‡å†…å­˜ç¼“å­˜\n        // âœ… å›¾ç‰‡ç´¢å¼•è·Ÿè¸ªï¼ˆè®°å½•æ¯ä¸ªè§’è‰²å½“å‰æ˜¾ç¤ºçš„æ˜¯ç¬¬å‡ å¼ å›¾ç‰‡ï¼‰\n        const imageIndexMap = ref(new Map());\n        /**\n         * è½»é‡é¢„çƒ­ï¼šæ¯ä¸ªè§’è‰²é¡ºåºæ¢æµ‹é¦–å¼ å›¾ç‰‡ï¼Œä½å¹¶å‘ä½å†…å­˜ã€‚\n         */\n        const smartBatchPreload = async () => {\n            if (isPreloading.value) {\n                console.log('[é¢„åŠ è½½] å·²æœ‰ä»»åŠ¡åœ¨è¿›è¡Œä¸­ï¼Œè·³è¿‡');\n                return;\n            }\n            isPreloading.value = true;\n            loadingProgress.value = 0;\n            const charCount = characterNames.value.length;\n            totalImages.value = Math.max(1, charCount);\n            preloadPhase.value = 'å¿«é€Ÿé¢„çƒ­ä¸­';\n            try {\n                for (let i = 0; i < charCount; i++) {\n                    const imageKey = mapRoleToImageName(characterNames.value[i], i);\n                    const urls = await fetchAvailableImages(imageKey, 1);\n                    if (urls.length) {\n                        preloadCache.value.set(imageKey, urls);\n                    }\n                }\n                preloadPhase.value = 'å®Œæˆ';\n                setTimeout(() => (preloadPhase.value = ''), 1500);\n            }\n            catch (e) {\n                console.error('[é¢„åŠ è½½] å¤±è´¥:', e);\n                preloadPhase.value = 'åŠ è½½å¤±è´¥';\n            }\n            finally {\n                isPreloading.value = false;\n            }\n        };\n        /**\n         * åŠ è½½å½“å‰è§’è‰²çš„å›¾ç‰‡\\n * ä¼˜å…ˆä½¿ç”¨é¢„åŠ è½½ç¼“å­˜ï¼Œä¸å‘½ä¸­åˆ™å³æ—¶å°æ‰¹æ¬¡æ¢æµ‹\n         */\n        const loadCurrentPhoto = async () => {\n            try {\n                const targetChar = activeChar.value;\n                const currentIndex = characterNames.value.indexOf(targetChar);\n                if (currentIndex === -1) {\n                    console.log(`[ç…§ç‰‡] å½“å‰è§’è‰²\"${targetChar}\"ä¸åœ¨è§’è‰²åˆ—è¡¨ä¸­`);\n                    currentPhotoUrl.value = '';\n                    return;\n                }\n                const imageKey = mapRoleToImageName(targetChar, currentIndex);\n                console.log(`[ç…§ç‰‡] è§’è‰²ç´¢å¼•: ${currentIndex}, è§’è‰²å: \"${targetChar}\", å›¾ç‰‡å: \"${imageKey}\"`);\n                // ä¼˜å…ˆä½¿ç”¨å·²ç¼“å­˜åˆ—è¡¨ï¼Œå¦åˆ™å³æ—¶æ¢æµ‹é¦–å¼ \n                const cached = preloadCache.value.get(imageKey);\n                const urls = cached && cached.length ? cached : await fetchAvailableImages(imageKey, 1);\n                if (activeChar.value !== targetChar) {\n                    console.log('[ç…§ç‰‡] ç”¨æˆ·å·²åˆ‡æ¢è§’è‰²ï¼Œæ”¾å¼ƒæ—§è¯·æ±‚');\n                    return;\n                }\n                if (urls && urls.length) {\n                    if (!imageIndexMap.value.has(imageKey))\n                        imageIndexMap.value.set(imageKey, 0);\n                    const currentIdx = imageIndexMap.value.get(imageKey) || 0;\n                    const picked = urls[currentIdx % urls.length];\n                    preloadCache.value.set(imageKey, urls);\n                    currentPhotoUrl.value = picked;\n                    console.log(`[ç…§ç‰‡] ${imageKey}: å‘½ä¸­${urls.length}å¼ ä¸­çš„ç¬¬${currentIdx + 1}å¼ `);\n                }\n                else {\n                    currentPhotoUrl.value = '';\n                    console.log(`[ç…§ç‰‡] ${imageKey}: æœªæ‰¾åˆ°å¯ç”¨å›¾ç‰‡`);\n                }\n            }\n            finally {\n                initializationComplete.value = true;\n            }\n        };\n        // åŸºç¡€ä¿¡æ¯æ˜ å°„\n        const basicInfo = computed(() => ({\n            'ğŸ‚ å¹´é¾„': activeCharData.value?.å¹´é¾„,\n            'ğŸ’¼ èº«ä»½': activeCharData.value?.èº«ä»½,\n            'ğŸ¤ å…³ç³»': activeCharData.value?.ä¸userå…³ç³»,\n            'ğŸ“ ä½ç½®': activeCharData.value?.æ‰€å¤„ä½ç½®,\n        }));\n        // å¤–è§‚ä¿¡æ¯æ˜ å°„\n        const appearanceInfo = computed(() => ({\n            'ğŸ‘” è¡£ç€': activeCharData.value?.è¡£ç€,\n            'ğŸŒ¸ èƒ¸ä¹³': activeCharData.value?.èƒ¸ä¹³,\n            'ğŸ‘™ å†…è¡£': activeCharData.value?.å†…è¡£,\n            'ğŸ”’ ç§å¤„': activeCharData.value?.ç§å¤„,\n            'ğŸ‘  é‹è¢œ': activeCharData.value?.é‹è¢œ,\n        }));\n        // --- æ ¸å¿ƒé€»è¾‘ ---\n        /**\n         * æ ¸å¿ƒæ•°æ®è·å–å‡½æ•°\n         * å…¼å®¹å¤šç§ APIï¼šgetCurrentMessageId / getLastMessageId\n         */\n        const fetchData = async () => {\n            try {\n                // æ£€æŸ¥é…’é¦†åŠ©æ‰‹æ¥å£æ˜¯å¦å¯ç”¨\n                const hasGetCurrent = typeof getCurrentMessageId === 'function';\n                const hasGetLast = typeof getLastMessageId === 'function';\n                const hasGetMsgs = typeof getChatMessages === 'function';\n                if (!hasGetMsgs) {\n                    console.warn('[é…’é¦†åŠ©æ‰‹] æ¥å£æœªåŠ è½½');\n                    return;\n                }\n                let targetMsg = null;\n                // å°è¯•å¤šç§æ–¹å¼è·å–æœ€æ–°æ¶ˆæ¯\n                if (hasGetCurrent) {\n                    // æ–¹å¼ 1: getCurrentMessageId (å¸¸è§äºæ—§ç‰ˆæœ¬)\n                    const msgId = getCurrentMessageId();\n                    if (msgId) {\n                        const msgs = getChatMessages(msgId);\n                        targetMsg = msgs && msgs.length > 0 ? msgs[0] : null;\n                    }\n                }\n                else if (hasGetLast) {\n                    // æ–¹å¼ 2: getLastMessageId (å¸¸è§äºæ–°ç‰ˆæœ¬)\n                    const lastId = getLastMessageId();\n                    if (lastId) {\n                        const msgs = getChatMessages(lastId);\n                        targetMsg = msgs && msgs.length > 0 ? msgs[0] : null;\n                    }\n                }\n                if (targetMsg?.data?.stat_data) {\n                    console.log('[é…’é¦†åŠ©æ‰‹] æˆåŠŸè·å–æ•°æ®');\n                    statData.value = targetMsg.data.stat_data;\n                    // ç­‰å¾… characterNames è®¡ç®—å±æ€§æ›´æ–°åå†æ£€æŸ¥\n                    await nextTick();\n                    // å¦‚æœå½“å‰æ²¡æœ‰é€‰ä¸­è§’è‰²ï¼Œä¸”æœ‰è§’è‰²æ•°æ®ï¼Œé»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª\n                    if (!activeChar.value && characterNames.value.length > 0) {\n                        console.log(`[é»˜è®¤] è‡ªåŠ¨é€‰ä¸­ç¬¬ä¸€ä¸ªè§’è‰²: \"${characterNames.value[0]}\"`);\n                        activeChar.value = characterNames.value[0];\n                    }\n                    // æ•°æ®æ›´æ–°åè°ƒæ•´é«˜åº¦ï¼ˆå»¶è¿Ÿç­‰å¾… DOM æ›´æ–°ï¼‰\n                    await nextTick();\n                    adjustHeight();\n                }\n            }\n            catch (e) {\n                console.warn('æ•°æ®åŒæ­¥å¤±è´¥:', e);\n            }\n        };\n        const handleManualRefresh = () => {\n            fetchData();\n            isImageLoading.value = true;\n            // æ¨¡æ‹ŸåŠ è½½åŠ¨ç”»\n            const btn = document.querySelector('.refresh-btn');\n            btn?.classList.add('spinning');\n            setTimeout(() => {\n                btn?.classList.remove('spinning');\n                isImageLoading.value = false;\n            }, 1000);\n        };\n        const switchCharacter = async (name) => {\n            console.log(`[åˆ‡æ¢] ğŸ’« åˆ‡æ¢è§’è‰²: \"${name}\"`);\n            // è®¾ç½®åŠ è½½çŠ¶æ€\n            isImageLoading.value = true;\n            try {\n                activeChar.value = name;\n                // è·å–æ–°è§’è‰²çš„ç´¢å¼•ï¼Œç”¨äºæ˜ å°„å›¾ç‰‡æ–‡ä»¶å\n                const newIndex = characterNames.value.indexOf(name);\n                const imageKey = mapRoleToImageName(name, newIndex);\n                // æ£€æŸ¥é¢„åŠ è½½ç¼“å­˜ï¼ˆæ”¹ä¸ºæ•°ç»„ï¼‰ï¼Œå¦‚æœå·²é¢„åŠ è½½åˆ™ç›´æ¥ä½¿ç”¨\n                if (preloadCache.value.has(imageKey)) {\n                    const preloadedUrls = preloadCache.value.get(imageKey);\n                    if (preloadedUrls && preloadedUrls.length > 0) {\n                        // åˆå§‹åŒ–æˆ–è·å–å½“å‰ç´¢å¼•\n                        if (!imageIndexMap.value.has(imageKey)) {\n                            // é¦–æ¬¡åˆ‡æ¢åˆ°è¯¥è§’è‰²ï¼Œéšæœºé€‰æ‹©ä¸€å¼ \n                            const randomIndex = Math.floor(Math.random() * preloadedUrls.length);\n                            imageIndexMap.value.set(imageKey, randomIndex);\n                        }\n                        const currentIdx = imageIndexMap.value.get(imageKey) || 0;\n                        currentPhotoUrl.value = preloadedUrls[currentIdx];\n                        console.log(`[åˆ‡æ¢] âš¡ ä½¿ç”¨é¢„åŠ è½½çš„å›¾ç‰‡ï¼Œé›¶å»¶è¿Ÿåˆ‡æ¢å®Œæˆ (å…±${preloadedUrls.length}å¼ ï¼Œæ˜¾ç¤ºç¬¬${currentIdx + 1}å¼ )`);\n                        isImageLoading.value = false;\n                        return;\n                    }\n                }\n                // å¦‚æœæ²¡æœ‰é¢„åŠ è½½ï¼Œåˆ™åŠ è½½æ–°è§’è‰²çš„å›¾ç‰‡\n                await loadCurrentPhoto();\n                console.log(`[åˆ‡æ¢] âœ… åˆ‡æ¢å®Œæˆ: \"${name}\"`);\n            }\n            catch (e) {\n                console.error(`[åˆ‡æ¢] âŒ åˆ‡æ¢å¤±è´¥:`, e);\n            }\n            finally {\n                isImageLoading.value = false;\n                // åˆ‡æ¢è§’è‰²åè°ƒæ•´é«˜åº¦\n                nextTick(adjustHeight);\n            }\n        };\n        const handleImageLoad = () => {\n            isImageLoading.value = false;\n            console.log('[ç…§ç‰‡] âœ… å›¾ç‰‡åŠ è½½æˆåŠŸå¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸­');\n            // å›¾ç‰‡åŠ è½½å®Œå¯èƒ½å½±å“é«˜åº¦\n            nextTick(() => setTimeout(adjustHeight, 100));\n        };\n        const handleImageError = (e) => {\n            isImageLoading.value = false;\n            const img = e.target;\n            console.warn('[ç…§ç‰‡] åŠ è½½å¤±è´¥ï¼Œå°è¯•ä¸‹ä¸€ä¸ªå¯ç”¨æº', {\n                src: img?.src?.substring(0, 50) + '...',\n            });\n            const currentIndex = characterNames.value.indexOf(activeChar.value);\n            const imageKey = mapRoleToImageName(activeChar.value, currentIndex);\n            // æ¸…é™¤å†…å­˜ç¼“å­˜å¹¶é‡æ–°æ¢æµ‹\n            imageCache.value.delete(imageKey);\n            fetchAvailableImages(imageKey, Math.min(MAX_CANDIDATES, 2)).then(urls => {\n                if (!urls.length) {\n                    currentPhotoUrl.value = '';\n                    return;\n                }\n                imageIndexMap.value.set(imageKey, 0);\n                preloadCache.value.set(imageKey, urls);\n                currentPhotoUrl.value = urls[0];\n            });\n        };\n        const toggleThemeModal = () => {\n            showThemeModal.value = !showThemeModal.value;\n        };\n        const handlePhotoClick = async () => {\n            const imageKey = mapRoleToImageName(activeChar.value, characterNames.value.indexOf(activeChar.value));\n            let info = currentImageInfo.value;\n            let images = info?.images || [];\n            let currentIndex = info?.currentIndex || 0;\n            if (!info || !info.hasMultiple) {\n                const freshUrls = await fetchAvailableImages(imageKey, MAX_CANDIDATES).catch(() => []);\n                if (freshUrls && freshUrls.length) {\n                    preloadCache.value.set(imageKey, freshUrls);\n                    imageIndexMap.value.set(imageKey, imageIndexMap.value.get(imageKey) ?? 0);\n                    images = freshUrls;\n                    currentIndex = imageIndexMap.value.get(imageKey) || 0;\n                    info = {\n                        imageKey,\n                        images,\n                        currentIndex,\n                        total: images.length,\n                        hasMultiple: images.length > 1,\n                    };\n                }\n                else {\n                    console.log('[ç…§ç‰‡] å½“å‰è§’è‰²åªæœ‰ä¸€å¼ å›¾ç‰‡æˆ–æœªåŠ è½½ï¼Œæ— æ³•åˆ‡æ¢');\n                    return;\n                }\n            }\n            const nextIndex = ((currentIndex || 0) + 1) % images.length;\n            imageIndexMap.value.set(imageKey, nextIndex);\n            currentPhotoUrl.value = images[nextIndex];\n            console.log(`[#ç…§ç‰‡] åˆ‡æ¢å›¾ç‰‡: ${imageKey} (ç¬¬${nextIndex + 1}/${images.length}å¼ )`);\n            const photoFrame = document.querySelector('.photo-frame');\n            if (photoFrame) {\n                photoFrame.classList.add('photo-clicked');\n                setTimeout(() => {\n                    photoFrame.classList.remove('photo-clicked');\n                }, 300);\n            }\n        };\n        // --- é«˜åº¦è‡ªé€‚åº”é€»è¾‘ (ä¼˜åŒ–ç‰ˆ) ---\n        const adjustHeight = () => {\n            if (!containerRef.value)\n                return;\n            // ä½¿ç”¨ requestAnimationFrame é¿å…å¸ƒå±€æŠ–åŠ¨\n            requestAnimationFrame(() => {\n                const height = containerRef.value?.scrollHeight || 300;\n                const finalHeight = Math.max(height, 300) + 20; // å¢åŠ ä¸€ç‚¹ç¼“å†²\n                // å‘é€æ¶ˆæ¯ç»™çˆ¶çº§ (é…’é¦†æ‰©å±•æ ‡å‡†åšæ³•)\n                if (window.parent && window.parent !== window) {\n                    window.parent.postMessage({\n                        type: 'adjustIframeHeight',\n                        height: finalHeight,\n                        scriptId: 'status-bar',\n                    }, '*');\n                }\n            });\n        };\n        // ç›‘å¬å™¨\n        let resizeObserver = null;\n        onMounted(async () => {\n            // 1. åˆå§‹åŒ–æ•°æ®\n            fetchData();\n            // 2. æ³¨å†Œäº‹ä»¶ç›‘å¬ (ä½¿ç”¨è§„èŒƒçš„ eventOn)\n            if (typeof eventOn === 'function' && typeof tavern_events !== 'undefined') {\n                // ç›‘å¬æ¶ˆæ¯æ›´æ–°å’Œæ¥æ”¶\n                eventOn(tavern_events.MESSAGE_UPDATED, fetchData);\n                eventOn(tavern_events.MESSAGE_RECEIVED, fetchData);\n                eventOn(tavern_events.CHAT_CHANGED, fetchData);\n            }\n            // 3. å¯åŠ¨é«˜åº¦ç›‘å¬\n            if (containerRef.value && typeof ResizeObserver !== 'undefined') {\n                resizeObserver = new ResizeObserver(() => adjustHeight());\n                resizeObserver.observe(containerRef.value);\n                resizeObserver.observe(document.body); // åŒæ—¶ä¹Ÿç›‘å¬ body å˜åŒ–\n            }\n            // 4. æ¢å¤ä¸»é¢˜\n            document.documentElement.setAttribute('data-theme', currentTheme.value);\n            // 5. ç­‰å¾…æ•°æ®åŠ è½½å®Œæˆåï¼Œå¯åŠ¨æ™ºèƒ½åˆ†æ‰¹é¢„åŠ è½½\n            const unwatch = watch(() => statData.value.è§’è‰², async (newRoles) => {\n                if (newRoles && Object.keys(newRoles).length > 0) {\n                    // ç­‰å¾…è§’è‰²è‡ªåŠ¨é€‰ä¸­å®Œæˆåå†å¯åŠ¨é¢„åŠ è½½\n                    if (activeChar.value) {\n                        // âœ¨ å¯åŠ¨æ™ºèƒ½åˆ†æ‰¹é¢„åŠ è½½ï¼ˆä¸awaitï¼Œä¸é˜»å¡UIï¼‰\n                        smartBatchPreload().catch(e => {\n                            console.error('[é¢„åŠ è½½] å¯åŠ¨å¤±è´¥:', e);\n                        });\n                        unwatch(); // åªæ‰§è¡Œä¸€æ¬¡\n                    }\n                }\n            }, { immediate: true });\n            // åŒæ—¶ç›‘å¬ activeChar çš„å˜åŒ–ï¼ˆç”¨æˆ·åˆ‡æ¢è§’è‰²æˆ–åˆå§‹åŒ–æ—¶è§¦å‘ï¼‰\n            watch(activeChar, newChar => {\n                if (newChar && characterNames.value.length > 0) {\n                    // åˆæ¬¡åŠ è½½è§’è‰²å›¾ç‰‡\n                    loadCurrentPhoto();\n                }\n            });\n        });\n        onUnmounted(() => {\n            if (resizeObserver)\n                resizeObserver.disconnect();\n            console.log('[æ¸…ç†] å·²æ–­å¼€è§‚å¯Ÿå™¨');\n        });\n        watch(activeChar, () => {\n            nextTick(adjustHeight);\n        });\n        watch(currentTheme, val => {\n            localStorage.setItem('tavern_helper_theme', val);\n            document.documentElement.setAttribute('data-theme', val);\n            nextTick(adjustHeight);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"main\", {\n                ref_key: \"containerRef\",\n                ref: containerRef,\n                class: \"glass-container\",\n                \"data-theme\": currentTheme.value\n            }, [\n                _createCommentVNode(\" é¡¶éƒ¨åŠŸèƒ½åŒº \"),\n                _createElementVNode(\"header\", _hoisted_2, [\n                    _createElementVNode(\"div\", { class: \"header-content\" }, [\n                        _cache[6] || (_cache[6] = _createElementVNode(\"h2\", { class: \"section-title\" }, [\n                            _createElementVNode(\"span\", { class: \"icon-pulse\" }, \"ğŸ“Š\"),\n                            _createElementVNode(\"span\", { class: \"title-text\" }, \"çŠ¶æ€ç›‘è§†å™¨\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", { class: \"header-actions\" }, [\n                            _createElementVNode(\"button\", {\n                                class: \"icon-btn refresh-btn\",\n                                title: \"å¼ºåˆ¶åˆ·æ–°æ•°æ®\",\n                                onClick: handleManualRefresh\n                            }, [...(_cache[4] || (_cache[4] = [\n                                    _createElementVNode(\"span\", null, \"ğŸ”„\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"icon-btn theme-toggle\",\n                                title: \"æ˜¾ç¤ºè®¾ç½®\",\n                                onClick: toggleThemeModal\n                            }, [...(_cache[5] || (_cache[5] = [\n                                    _createElementVNode(\"span\", { class: \"gear-icon\" }, \"âš™ï¸\", -1 /* CACHED */)\n                                ]))])\n                        ])\n                    ]),\n                    _createCommentVNode(\" âœ¨ åŠ è½½è¿›åº¦æ¡ \"),\n                    _createVNode(_Transition, { name: \"fade-slide\" }, {\n                        default: _withCtx(() => [\n                            (isPreloading.value || preloadPhase.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"progress-icon\" }, \"ğŸ“¦\", -1 /* CACHED */)),\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(preloadPhase.value || 'åŠ è½½ä¸­'), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(loadingProgress.value) + \" / \" + _toDisplayString(totalImages.value), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"div\", {\n                                            class: \"progress-fill\",\n                                            style: _normalizeStyle({ width: `${(loadingProgress.value / totalImages.value) * 100}%` })\n                                        }, null, 4 /* STYLE */)\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _: 1 /* STABLE */\n                    }),\n                    _createCommentVNode(\" åŸºç¡€ä¿¡æ¯å¡ç‰‡ \"),\n                    _createElementVNode(\"div\", _hoisted_8, [\n                        _createElementVNode(\"div\", _hoisted_9, [\n                            _createElementVNode(\"div\", _hoisted_10, [\n                                _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"icon\" }, \"ğŸ“–\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_11, [\n                                    _cache[8] || (_cache[8] = _createElementVNode(\"span\", { class: \"label\" }, \"å½“å‰ç« èŠ‚\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_12, _toDisplayString(statData.value.ç« èŠ‚ || 'ç­‰å¾…æ•°æ®...'), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_13, [\n                                _cache[11] || (_cache[11] = _createElementVNode(\"span\", { class: \"icon\" }, \"ğŸ•\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_14, [\n                                    _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"label\" }, \"ä¸–ç•Œæ—¶é—´\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_15, _toDisplayString(statData.value.æ—¶é—´ || 'æœªçŸ¥æ—¶é—´'), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_16, [\n                                _cache[13] || (_cache[13] = _createElementVNode(\"span\", { class: \"icon\" }, \"ğŸ“\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_17, [\n                                    _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"label\" }, \"å½“å‰åœ°ç‚¹\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_18, _toDisplayString(statData.value.å½“å‰åœ°ç‚¹ || 'æœªçŸ¥åœ°ç‚¹'), 1 /* TEXT */)\n                                ])\n                            ])\n                        ]),\n                        _createCommentVNode(\" è§’è‰²ç…§ç‰‡åŒº \"),\n                        _createElementVNode(\"div\", _hoisted_19, [\n                            _createElementVNode(\"div\", {\n                                class: _normalizeClass([\"photo-frame\", {\n                                        'has-photo': currentPhotoUrl.value && imagesLoaded.value,\n                                        loading: isImageLoading.value || !imagesLoaded.value,\n                                    }]),\n                                onClick: handlePhotoClick\n                            }, [\n                                (isImageLoading.value || !imagesLoaded.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20))\n                                    : _createCommentVNode(\"v-if\", true),\n                                (currentPhotoUrl.value)\n                                    ? (_openBlock(), _createElementBlock(\"img\", {\n                                        key: 1,\n                                        src: currentPhotoUrl.value,\n                                        alt: activeChar.value,\n                                        class: \"char-photo\",\n                                        onError: handleImageError,\n                                        onLoad: handleImageLoad\n                                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_21))\n                                    : (imagesLoaded.value)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_22, [...(_cache[14] || (_cache[14] = [\n                                                _createElementVNode(\"span\", { class: \"placeholder-icon\" }, \"ğŸ‘¤\", -1 /* CACHED */),\n                                                _createElementVNode(\"span\", { class: \"placeholder-text\" }, \"NO IMAGE\", -1 /* CACHED */)\n                                            ]))]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [...(_cache[15] || (_cache[15] = [\n                                                _createElementVNode(\"span\", { class: \"placeholder-icon\" }, \"â³\", -1 /* CACHED */),\n                                                _createElementVNode(\"span\", { class: \"placeholder-text\" }, \"LOADING...\", -1 /* CACHED */)\n                                            ]))]))\n                            ], 2 /* CLASS */),\n                            _createElementVNode(\"div\", _hoisted_24, [\n                                _createElementVNode(\"span\", _hoisted_25, _toDisplayString(cleanCharName(activeChar.value || 'æœªçŸ¥è§’è‰²')), 1 /* TEXT */),\n                                _createElementVNode(\"span\", {\n                                    class: _normalizeClass([\"char-status-dot\", { active: hasCharacters.value }])\n                                }, null, 2 /* CLASS */),\n                                _createCommentVNode(\" âœ¨ å›¾ç‰‡è®¡æ•°æ˜¾ç¤º \"),\n                                (currentImageInfo.value && currentImageInfo.value.hasMultiple)\n                                    ? (_openBlock(), _createElementBlock(\"span\", {\n                                        key: 0,\n                                        class: \"image-counter\",\n                                        title: `ç‚¹å‡»å›¾ç‰‡åˆ‡æ¢ï¼ˆå…±${currentImageInfo.value.total}å¼ ï¼‰`\n                                    }, _toDisplayString(currentImageInfo.value.currentIndex + 1) + \"/\" + _toDisplayString(currentImageInfo.value.total), 9 /* TEXT, PROPS */, _hoisted_26))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ])\n                    ])\n                ]),\n                _createCommentVNode(\" è§’è‰²è¯¦æƒ…åŒº \"),\n                _createElementVNode(\"section\", _hoisted_27, [\n                    _createCommentVNode(\" è¯¦æƒ…å†…å®¹ \"),\n                    _createVNode(_Transition, {\n                        name: \"fade-slide\",\n                        mode: \"out-in\"\n                    }, {\n                        default: _withCtx(() => [\n                            (activeCharData.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", {\n                                    key: activeChar.value,\n                                    class: \"tab-content\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_28, [\n                                        _createCommentVNode(\" äººç‰©é€‰æ‹©å¡ç‰‡ - å…¨å®½ \"),\n                                        _createElementVNode(\"div\", _hoisted_29, [\n                                            _cache[16] || (_cache[16] = _createElementVNode(\"h3\", null, \"ğŸ‘¥ äººç‰©é€‰æ‹©\", -1 /* CACHED */)),\n                                            _createElementVNode(\"nav\", _hoisted_30, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(cleanedCharacterNames.value, (cleanName, index) => {\n                                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                                        key: characterNames.value[index],\n                                                        class: _normalizeClass([\"tab-button\", { active: characterNames.value[index] === activeChar.value }]),\n                                                        onClick: ($event) => (switchCharacter(characterNames.value[index]))\n                                                    }, [\n                                                        _createTextVNode(_toDisplayString(cleanName) + \" \", 1 /* TEXT */),\n                                                        _createCommentVNode(\" âœ… æ˜¾ç¤ºæ¸…ç†åçš„åå­— \")\n                                                    ], 10 /* CLASS, PROPS */, _hoisted_31));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ]),\n                                        _createCommentVNode(\" å¿ƒç†ä¸å§¿æ€ (å…¨å®½) \"),\n                                        (activeCharData.value.å½“å‰æƒ³æ³•)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_32, [\n                                                _cache[17] || (_cache[17] = _createElementVNode(\"h3\", null, \"ğŸ’­ å†…å¿ƒæƒ³æ³•\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_33, _toDisplayString(activeCharData.value.å½“å‰æƒ³æ³•), 1 /* TEXT */)\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (activeCharData.value.å§¿åŠ¿)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_34, [\n                                                _cache[18] || (_cache[18] = _createElementVNode(\"h3\", null, \"ğŸƒ å½“å‰å§¿æ€\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_35, _toDisplayString(activeCharData.value.å§¿åŠ¿), 1 /* TEXT */)\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createCommentVNode(\" åŸºç¡€å±æ€§ \"),\n                                        _createElementVNode(\"div\", _hoisted_36, [\n                                            _cache[19] || (_cache[19] = _createElementVNode(\"h3\", null, \"ğŸ“‹ çŠ¶æ€é¢æ¿\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_37, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(basicInfo.value, (val, key) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: key,\n                                                        class: \"detail-item\"\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_38, _toDisplayString(key.replace(/^[^\\u4e00-\\u9fa5]+/, '')), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_39, _toDisplayString(val || '--'), 1 /* TEXT */)\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ]),\n                                        _createCommentVNode(\" å¤–è§‚ç‰¹å¾ \"),\n                                        _createElementVNode(\"div\", _hoisted_40, [\n                                            _cache[20] || (_cache[20] = _createElementVNode(\"h3\", null, \"ğŸ‘¤ å¤–è§‚ç‰¹å¾\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_41, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(appearanceInfo.value, (val, key) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: key,\n                                                        class: \"appearance-item\"\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_42, _toDisplayString(key.replace(/^[^\\u4e00-\\u9fa5]+/, '')), 1 /* TEXT */),\n                                                        _createElementVNode(\"div\", _hoisted_43, _toDisplayString(val || '--'), 1 /* TEXT */)\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ])\n                                    ])\n                                ]))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_44, [\n                                    _cache[21] || (_cache[21] = _createElementVNode(\"div\", { class: \"empty-icon\" }, \"ğŸ“¡\", -1 /* CACHED */)),\n                                    (!imagesLoaded.value)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_45, \"åŠ è½½ä¸­...\"))\n                                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_46, \"è¯·é€‰æ‹©ä¸€ä¸ªè§’è‰²\")),\n                                    (!imagesLoaded.value)\n                                        ? (_openBlock(), _createElementBlock(\"small\", _hoisted_47, \"æ­£åœ¨åŒæ­¥é…’é¦†æ•°æ®\"))\n                                        : (_openBlock(), _createElementBlock(\"small\", _hoisted_48, \"ç‚¹å‡»ä¸Šæ–¹é€‰é¡¹å¡æŸ¥çœ‹è§’è‰²ä¿¡æ¯\"))\n                                ]))\n                        ]),\n                        _: 1 /* STABLE */\n                    })\n                ]),\n                _createCommentVNode(\" è®¾ç½®å¼¹çª— \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (showThemeModal.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"modal-overlay\",\n                                onClick: _cache[3] || (_cache[3] = ($event) => (showThemeModal.value = false))\n                            }, [\n                                _createElementVNode(\"div\", {\n                                    class: \"modal-content glass-panel\",\n                                    onClick: _cache[2] || (_cache[2] = _withModifiers(() => { }, [\"stop\"]))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_49, [\n                                        _cache[22] || (_cache[22] = _createElementVNode(\"h3\", null, \"ç•Œé¢è®¾ç½®\", -1 /* CACHED */)),\n                                        _createElementVNode(\"button\", {\n                                            class: \"btn-close\",\n                                            onClick: _cache[0] || (_cache[0] = ($event) => (showThemeModal.value = false))\n                                        }, \"Ã—\")\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_50, [\n                                        _cache[24] || (_cache[24] = _createElementVNode(\"label\", null, \"ğŸ¨ ä¸»é¢˜é£æ ¼\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((currentTheme).value = $event))\n                                        }, [...(_cache[23] || (_cache[23] = [\n                                                _createElementVNode(\"option\", { value: \"default\" }, \"âœ¨ æå…‰ç»ç’ƒ (é»˜è®¤)\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"dark\" }, \"ğŸŒ‘ æ·±ç©ºå¹½è“\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"classic_vintage\" }, \"ğŸ“œ ç¾Šçš®å·è½´\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, currentTheme.value]\n                                        ])\n                                    ])\n                                ])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ], 8 /* PROPS */, _hoisted_1));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=08cefee2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-08cefee2\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport App from './App.vue';\nimport './index.scss';\n\n$(() => {\n  const mountPoint = document.getElementById('app');\n\n  if (!mountPoint) {\n    console.error('LingDong: Mount point #app not found!');\n    return;\n  }\n\n  // ? é˜²é‡å¤æŒ‚è½½ï¼šè‹¥å½“å‰ iframe å†…å·²å­˜åœ¨ Vue å†…å®¹ï¼Œåˆ™è·³è¿‡\n  if (mountPoint.hasChildNodes()) {\n    console.log('[çŠ¶æ€æ ] å·²å­˜åœ¨ï¼Œè·³è¿‡é‡å¤åŠ è½½');\n    return;\n  }\n\n  const app = createApp(App);\n  app.mount(mountPoint);\n\n  console.log('LingDong: Vue App Mounted Successfully.');\n\n  // ä¸¥æ ¼éµå¾ªè§„èŒƒï¼šä½¿ç”¨ pagehide æ¸…ç†èµ„æº\n  $(window).on('pagehide', () => {\n    app.unmount();\n    console.log('LingDong: Vue App Unmounted.');\n  });\n});\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","Vue","_hoisted_1","_hoisted_2","class","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","__name","setup","__props","cdnMirrors","probeImage","url","Promise","resolve","img","Image","onload","onerror","src","imageCache","ref","Map","fetchAvailableImages","async","imageKey","need","cached","value","get","length","slice","candidates","limit","urls","idx","suffix","mirror","push","encodeURIComponent","buildImageUrls","found","isPreloading","loadingProgress","set","containerRef","statData","activeChar","showThemeModal","currentTheme","localStorage","getItem","isImageLoading","totalImages","preloadPhase","characterNames","computed","Object","keys","hasCharacters","currentImageInfo","currentIndex","indexOf","mapRoleToImageName","images","preloadCache","imageIndexMap","total","hasMultiple","initializationComplete","imagesLoaded","currentPhotoUrl","cleanedCharacterNames","map","name","cleanCharName","activeCharData","data","console","log","trim","roleName","roleIndex","loadCurrentPhoto","targetChar","has","currentIdx","picked","basicInfo","appearanceInfo","fetchData","hasGetCurrent","getCurrentMessageId","hasGetLast","getLastMessageId","getChatMessages","warn","targetMsg","msgId","msgs","lastId","stat_data","nextTick","adjustHeight","e","handleManualRefresh","btn","document","querySelector","classList","add","setTimeout","remove","handleImageLoad","handleImageError","substring","delete","Math","min","then","toggleThemeModal","handlePhotoClick","info","freshUrls","catch","nextIndex","photoFrame","requestAnimationFrame","height","scrollHeight","finalHeight","max","window","parent","postMessage","type","scriptId","resizeObserver","onMounted","eventOn","tavern_events","MESSAGE_UPDATED","MESSAGE_RECEIVED","CHAT_CHANGED","ResizeObserver","observe","body","documentElement","setAttribute","unwatch","watch","newRoles","charCount","i","error","smartBatchPreload","immediate","newChar","onUnmounted","disconnect","setItem","_ctx","_cache","ref_key","title","onClick","default","style","width","_","loading","alt","onError","onLoad","active","mode","cleanName","index","$event","newIndex","preloadedUrls","randomIndex","floor","random","replace","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","$","mountPoint","getElementById","hasChildNodes","app","createApp","App","mount","on","unmount"],"ignoreList":[],"sourceRoot":""}