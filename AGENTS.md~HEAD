# é…’é¦†åŠ©æ‰‹å‰ç«¯ç•Œé¢ä¸è„šæœ¬å¼€å‘ - AGENTSè§„èŒƒ

> æœ¬æ–‡æ¡£ä¸ºAIç¼–ç åŠ©æ‰‹æä¾›å®Œæ•´çš„é¡¹ç›®å¼€å‘è§„èŒƒã€æŠ€æœ¯è·¯çº¿å’Œå·¥å…·ä½¿ç”¨æŒ‡å—

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [é¡¹ç›®ç»“æ„ä¸åˆ†ç±»](#2-é¡¹ç›®ç»“æ„ä¸åˆ†ç±»)
3. [æ ¸å¿ƒæŠ€æœ¯æ ˆ](#3-æ ¸å¿ƒæŠ€æœ¯æ ˆ)
4. [æ¥å£ä½¿ç”¨è§„èŒƒ](#4-æ¥å£ä½¿ç”¨è§„èŒƒ)
5. [æ„å»ºé…ç½®è§„èŒƒ](#5-æ„å»ºé…ç½®è§„èŒƒ)
6. [é…’é¦†å˜é‡ç³»ç»Ÿ](#6-é…’é¦†å˜é‡ç³»ç»Ÿ)
7. [å‰ç«¯ç•Œé¢å¼€å‘](#7-å‰ç«¯ç•Œé¢å¼€å‘)
8. [è„šæœ¬å¼€å‘](#8-è„šæœ¬å¼€å‘)
9. [MVUå˜é‡æ¡†æ¶](#9-mvuå˜é‡æ¡†æ¶)
10. [Chrome DevTools MCP](#10-chrome-devtools-mcp)
11. [å‰ç«¯ç¾åŒ–è®¾è®¡æŠ€èƒ½ç³»ç»Ÿ](#11-å‰ç«¯ç¾åŒ–è®¾è®¡æŠ€èƒ½ç³»ç»Ÿ)
12. [æœ€ä½³å®è·µ](#12-æœ€ä½³å®è·µ)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®å®šä½

æœ¬é¡¹ç›®ä¸“é—¨ç”¨äºç¼–å†™é…’é¦†åŠ©æ‰‹ ([Tavern Helper](https://n0vi028.github.io/JS-Slash-Runner-Doc/guide/å…³äºé…’é¦†åŠ©æ‰‹/ä»‹ç».html)) æ‰€æ”¯æŒçš„å‰ç«¯ç•Œé¢æˆ–è„šæœ¬ã€‚å®ƒä»¬åœ¨é…’é¦† (SillyTavern) ä¸­ä»¥å‰å°æˆ–åå°çš„å½¢å¼è¿è¡Œï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨é…’é¦†åŠ©æ‰‹æ‰€æä¾›çš„æ¥å£ã€‚

### 1.2 åº”ç”¨åœºæ™¯

- **UIç¾åŒ–**: ä¸ºè§’è‰²å¡æä¾›æ›´å¥½çš„UIæ˜¾ç¤ºï¼Œå¦‚å°†æ¶ˆæ¯æ¥¼å±‚ä¸­çº¯æ–‡æœ¬çš„çŠ¶æ€æ ç¾åŒ–ä¸ºæœ‰åŠ¨æ€æ•ˆæœã€æœ‰äº¤äº’çš„HTMLçŠ¶æ€æ 
- **äº¤äº’å¢å¼º**: å®ç°éçº¯æ–‡æœ¬çš„æ¸¸ç©ä½“éªŒï¼Œå¦‚ç›‘å¬ç°å®æ—¶é—´æˆ–é…’é¦†äº‹ä»¶æ¥å®ç°metaæ¸¸æˆã€æ’­æ”¾å¤šåª’ä½“æ–‡ä»¶
- **ä½“éªŒä¼˜åŒ–**: ä¼˜åŒ–é…’é¦†ä½¿ç”¨ä½“éªŒï¼Œå¦‚ç”¨jQueryä¸ºé¢„è®¾æç¤ºè¯æ¡ç›®æ–°å¢å¤åˆ¶æŒ‰é’®
- **å¤–éƒ¨è¿æ¥**: è¿æ¥å¤–éƒ¨åº”ç”¨ç¨‹åºï¼Œå¦‚é€šè¿‡socket.io-clientè¿æ¥å¤–éƒ¨æœåŠ¡å™¨
- **åŠŸèƒ½æ‰©å±•**: æ–°å¢é¢å¤–åŠŸèƒ½ï¼Œå¦‚æ¯20æ¥¼åœ¨åå°è°ƒç”¨ä¸€æ¬¡LLMæ¥ç”Ÿæˆå¯¹ä¹‹å‰å‰§æƒ…çš„æ€»ç»“

### 1.3 æŠ€æœ¯ç‰¹æ€§

- **è¿è¡Œæ–¹å¼**: æ‰€æœ‰ä»£ç åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæ”¯æŒiframeæ²™ç›’éš”ç¦»
- **å¼€å‘è¯­è¨€**: TypeScriptï¼ˆä¸¥æ ¼ç±»å‹æ£€æŸ¥ï¼‰
- **å‰ç«¯æ¡†æ¶**: Vue 3 + Composition API
- **çŠ¶æ€ç®¡ç†**: Pinia + Zodï¼ˆæ•°æ®æ ¡éªŒï¼‰
- **æ ·å¼æ–¹æ¡ˆ**: SCSS + Vue SFC scoped styles
- **æ„å»ºå·¥å…·**: Webpack 5ï¼ˆå·²é…ç½®å®Œæ•´loaderå’Œæ’ä»¶ï¼‰

---

## 2. é¡¹ç›®ç»“æ„ä¸åˆ†ç±»

### 2.1 ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ APP/              # å‰ç«¯ç•Œé¢é¡¹ç›®
â”œâ”€â”€ ç•Œé¢ç¤ºä¾‹/          # ç•Œé¢é¡¹ç›®æ¨¡æ¿
â”œâ”€â”€ è„šæœ¬ç¤ºä¾‹/          # è„šæœ¬é¡¹ç›®æ¨¡æ¿
â””â”€â”€ æ¨¡æ¿/             # é¡¹ç›®æ¨¡æ¿æ–‡ä»¶å¤¹

dist/                 # æ„å»ºè¾“å‡ºç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ APP/
â”œâ”€â”€ ç•Œé¢ç¤ºä¾‹/
â””â”€â”€ è„šæœ¬ç¤ºä¾‹/
```

### 2.2 é¡¹ç›®ç±»å‹åˆ¤å®š

- **å‰ç«¯ç•Œé¢é¡¹ç›®**: `src/xxx` æ–‡ä»¶å¤¹ä¸­æ—¢æœ‰ `index.ts` ä¹Ÿæœ‰ `index.html`
  - ç‰¹ç‚¹: å‰å°æ˜¾ç¤ºï¼Œæœ‰ç‹¬ç«‹UIç•Œé¢
  - ç¤ºä¾‹: `src/APP`, `src/ç•Œé¢ç¤ºä¾‹`

- **è„šæœ¬é¡¹ç›®**: `src/xxx` æ–‡ä»¶å¤¹ä¸­ä»…æœ‰ `index.ts`
  - ç‰¹ç‚¹: åå°è¿è¡Œï¼Œæ— ç•Œé¢
  - ç¤ºä¾‹: `src/è„šæœ¬ç¤ºä¾‹`

---

## 3. æ ¸å¿ƒæŠ€æœ¯æ ˆ

### 3.1 ä¾èµ–åº“

é¡¹ç›®ä½¿ç”¨pnpmä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œé¢„è£…ä»¥ä¸‹ç¬¬ä¸‰æ–¹åº“ï¼š

**æ ¸å¿ƒæ¡†æ¶:**
- `vue` - Vue 3 æ¡†æ¶
- `vue-router` - Vueè·¯ç”±
- `pinia` - çŠ¶æ€ç®¡ç†

**å¼€å‘å·¥å…·:**
- `typescript` - TypeScriptæ”¯æŒ
- `jquery` - DOMæ“ä½œ
- `lodash` - å·¥å…·åº“
- `zod` - æ•°æ®æ ¡éªŒ
- `toastr` - æ¶ˆæ¯æç¤º

**è§†è§‰ä¸åŠ¨ç”»:**
- `gsap` - åŠ¨ç”»åº“
- `pixi.js` - 2Dæ¸²æŸ“
- `@pixi/react` - Reacté›†æˆ

**å…¶ä»–:**
- `dedent` - æ–‡æœ¬æ ¼å¼åŒ–
- `jquery-ui` - UIç»„ä»¶
- `yaml` - YAMLè§£æ

### 3.2 ç¬¬ä¸‰æ–¹åº“ä½¿ç”¨åŸåˆ™

- **ä¼˜å…ˆä½¿ç”¨ç¬¬ä¸‰æ–¹åº“**è€Œä¸æ˜¯åŸç”ŸAPI
- ä½¿ç”¨`jquery`è€Œä¸æ˜¯åŸç”ŸDOMæ“ä½œ
- ä½¿ç”¨`zod`è¿›è¡Œæ•°æ®æ ¡éªŒå’Œçº é”™
- ä½¿ç”¨`gsap`åˆ¶ä½œåŠ¨ç”»æ•ˆæœ
- ä½¿ç”¨`vueuse`æä¾›çš„ç»„åˆå¼API

### 3.3 CDNä½¿ç”¨ä¸ç¬¬ä¸‰æ–¹åº“ç®¡ç†

é¡¹ç›®æä¾›å…è´¹çš„CDNæœåŠ¡æ”¯æŒï¼Œæ‰€æœ‰ç¬¬ä¸‰æ–¹åº“å’ŒGitHubæ–‡ä»¶éƒ½å¯ä»¥é€šè¿‡CDNè®¿é—®ã€‚

**å›½å†…è®¿é—®ä¼˜åŒ–**ï¼š
- ä½¿ç”¨ `https://testingcf.jsdelivr.net` é•œåƒç¡®ä¿å›½å†…ç½‘ç»œç¯å¢ƒå¯æ­£å¸¸è®¿é—®
- ä¸æ¨èä½¿ç”¨ `https://cdn.jsdelivr.net`ï¼ˆå›½å†…å¯èƒ½æ— æ³•è®¿é—®ï¼‰

**ç¬¬ä¸‰æ–¹åº“æ·»åŠ ä¸ç®¡ç†**ï¼š
- ä¸ºé¡¹ç›®æ·»åŠ ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œ**æ¨èä½¿ç”¨** `pnpm add ç¬¬ä¸‰æ–¹åº“å` æ¥å®‰è£…
- æ¨¡æ¿æ–‡ä»¶å¤¹å·²é…ç½®webpackï¼Œä¼šåœ¨æ‰“åŒ…æ—¶è‡ªåŠ¨å°†ç¬¬ä¸‰æ–¹åº“è½¬æ¢ä¸ºjsdelivr CDNé“¾æ¥
- è¿™å¯ä»¥é¿å…åœ¨å¤šä¸ªè„šæœ¬æˆ–ç•Œé¢ä¸­é‡å¤æ‰“åŒ…ç›¸åŒçš„ç¬¬ä¸‰æ–¹åº“ï¼Œå‡å°‘æ€»ä½“ç§¯
- è½¬æ¢åçš„CDNé“¾æ¥å°†ä½¿ç”¨ `https://testingcf.jsdelivr.net/npm/` å‰ç¼€

**æ‰‹åŠ¨CDNå¼•ç”¨**ï¼š
å¦‚æœæ‚¨éœ€è¦ç›´æ¥åœ¨è„šæœ¬æˆ–ç•Œé¢ä¸­å¼•ç”¨CDNèµ„æºï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨å›½å†…å¯è®¿é—®çš„é•œåƒ
importSomething from 'https://testingcf.jsdelivr.net/npm/package-name@version/+esm';

// âŒ é”™è¯¯ï¼šå¯èƒ½æ— æ³•åœ¨å›½å†…è®¿é—®
importSomething from 'https://cdn.jsdelivr.net/npm/package-name@version/+esm';
```

---

## 4. æ¥å£ä½¿ç”¨è§„èŒƒ

### 4.1 @typesç›®å½•é™åˆ¶ âš ï¸ **é‡è¦**

- `@types`ç›®å½•åŒ…å«äº†æ‰€æœ‰é…’é¦†å’Œé…’é¦†åŠ©æ‰‹æä¾›çš„ä¾èµ–å‡½æ•°ã€æ¥å£å’Œç±»å‹å®šä¹‰
- **ç¦æ­¢è¶…å‡º**`@types`æ–‡ä»¶å¤¹ä¸­å®šä¹‰çš„å‡½æ•°å’Œæ¥å£è¿›è¡Œå¼€å‘
- ä¸å¾—è‡ªå»ºæ¥å£æˆ–ä½¿ç”¨æœªåœ¨`@types`ä¸­å®šä¹‰çš„å…¨å±€å‡½æ•°

### 4.2 @typesç›®å½•ç»“æ„

**function/ç›®å½• - æ ¸å¿ƒåŠŸèƒ½å‡½æ•°:**
- `variables.d.ts` - å˜é‡æ“ä½œï¼š`getVariables`ã€`replaceVariables`ã€`klona`
- `chat_message.d.ts` - æ¶ˆæ¯å¤„ç†ï¼š`getChatMessages`ã€`sendMessage`ã€`getCurrentMessageId`
- `slash.d.ts` - STScriptå‘½ä»¤ï¼š`triggerSlash`ã€`waitGlobalInitialized`
- `script.d.ts` - è„šæœ¬ç®¡ç†ï¼š`getScriptId`ã€`eventOn`ã€`getButtonEvent`
- `builtin.d.ts` - å†…ç½®å·¥å…·ï¼š`toastr`ã€`$`ã€`jQuery`
- `generate.d.ts` - å†…å®¹ç”Ÿæˆï¼š`generate`
- `character.d.ts` - è§’è‰²å¡ï¼š`getCurrentCharacterId`ã€`getCharacterCard`
- `global.d.ts` - å…¨å±€APIï¼š`getIframeName`ã€`window`ã€`document`
- `audio.d.ts` - éŸ³é¢‘æ’­æ”¾ï¼š`playAudio`
- `lorebook.d.ts` - ä¸–ç•Œä¹¦ï¼š`replaceWorldbook`
- `util.d.ts` - å·¥å…·å‡½æ•°ï¼š`klona`

**iframe/ç›®å½• - æ¡†æ¶å’Œæ’ä»¶æ¥å£:**
- `exported.sillytavern.d.ts` - é…’é¦†åŸç”ŸAPI
- `exported.tavernhelper.d.ts` - é…’é¦†åŠ©æ‰‹API
- `exported.mvu.d.ts` - MVUå˜é‡æ¡†æ¶ï¼š`Mvu.getMvuData`ã€`Mvu.parseMessage`
- `exported.ejstemplate.d.ts` - EJSæ¨¡æ¿å¼•æ“
- `event.d.ts` - äº‹ä»¶ç³»ç»Ÿï¼š`tavern_events`
- `script.d.ts` - è„šæœ¬æ¡†æ¶ï¼š`waitForInit`
- `util.d.ts` - iframeå·¥å…·
- `variables.d.ts` - iframeå˜é‡æ“ä½œ

### 4.3 æ¥å£ä½¿ç”¨ç¤ºä¾‹

```typescript
// å˜é‡æ“ä½œ
getVariables({type: 'script', script_id: getScriptId()})

// æ¶ˆæ¯å¤„ç†
getChatMessages(getCurrentMessageId())

// äº‹ä»¶ç›‘å¬
eventOn(getButtonEvent('æŒ‰é’®å'), callback)

// MVUæ¡†æ¶ï¼ˆéœ€å…ˆåˆå§‹åŒ–ï¼‰
await waitGlobalInitialized('Mvu')
Mvu.getMvuData({type: 'message', message_id: 'latest'})
```

---

## 5. æ„å»ºé…ç½®è§„èŒƒ

### 5.1 webpack.config.ts ç¦æ­¢ä¿®æ”¹ âš ï¸ **é‡è¦**

`webpack.config.ts`æ˜¯é¡¹ç›®çš„æ„å»ºé…ç½®æ–‡ä»¶ï¼Œ**ä¸å…è®¸ä¿®æ”¹**ã€‚

### 5.2 å·²é…ç½®çš„Loaderå’Œæ’ä»¶

- **Vue Loader** - ç”¨äºVue SFCç¼–è¯‘
- **TypeScript Loader** - ç”¨äº.ts/.tsxæ–‡ä»¶ç¼–è¯‘
- **SCSS Loader** - ç”¨äº.scssæ–‡ä»¶ç¼–è¯‘å’Œæå–
- **MiniCssExtractPlugin** - ç”¨äºCSSæå–
- **HtmlWebpackPlugin** - ç”¨äºHTMLæ‰“åŒ…
- **VueUseè‡ªåŠ¨å¯¼å…¥** - è‡ªåŠ¨å¯¼å…¥ç»„ä»¶å’ŒæŒ‡ä»¤
- **ä»£ç æ··æ·†å’Œå‹ç¼©ä¼˜åŒ–** - æ··æ·†ä»£ç ï¼Œæå‡æ€§èƒ½

### 5.3 ç‰¹æ®Šå¯¼å…¥æ–¹å¼

```typescript
// 1. å¯¼å…¥æ–‡ä»¶å†…å®¹ï¼ˆåŸå§‹å­—ç¬¦ä¸²ï¼‰
import html_content from './html.html?raw';
import json_content from './json.json?raw';

// 2. å¯¼å…¥HTMLï¼ˆæœ€å°åŒ–ï¼‰
import html from './file.html';

// 3. å¯¼å…¥Markdownï¼ˆè§£æä¸ºHTMLï¼‰
import markdown from './file.md';

// 4. å¯¼å…¥Vueç»„ä»¶
import Component from './Component.vue';

// 5. å¯¼å…¥æ ·å¼ï¼ˆè‡ªåŠ¨æ’å…¥<head>ï¼‰
import './index.scss';
```

---

## 6. é…’é¦†å˜é‡ç³»ç»Ÿ

### 6.1 å˜é‡ç±»å‹

é…’é¦†å˜é‡ç”¨äºæŒä¹…åŒ–å­˜å‚¨å‰ç«¯ç•Œé¢ã€è„šæœ¬çš„æ•°æ®ï¼Œå¯é€šè¿‡é…’é¦†åŠ©æ‰‹çš„`getVariables`ã€`replaceVariables`ç­‰æ¥å£è¯»å†™ã€‚

- **å…¨å±€å˜é‡**: åœ¨é…’é¦†ä¸­å…¨å±€ä¸€è‡´ï¼Œæ— è®ºæ˜¯å¦æ‰“å¼€è§’è‰²å¡ã€å“ªå¼ è§’è‰²å¡ï¼Œéƒ½å…±äº«åŒæ ·çš„å…¨å±€å˜é‡
- **è§’è‰²å¡å˜é‡**: ç»‘å®šåœ¨è§’è‰²å¡ä¸Šçš„å˜é‡
- **è„šæœ¬å˜é‡**: ç»‘å®šåœ¨æŸä¸ªè„šæœ¬ä¸Šçš„å˜é‡
- **èŠå¤©å˜é‡**: ç»‘å®šåœ¨æŸè§’è‰²å¡çš„æŸä¸ªèŠå¤©æ–‡ä»¶ä¸Šçš„å˜é‡
- **æ¶ˆæ¯æ¥¼å±‚å˜é‡**: ç»‘å®šåœ¨æŸè§’è‰²å¡ã€æŸèŠå¤©çš„æŸä¸ªæ¥¼å±‚ä¸Š

### 6.2 ä½¿ç”¨ç¤ºä¾‹

```typescript
// è¯»å–å˜é‡
const variables = getVariables({type: 'global'});

// å†™å…¥å˜é‡
replaceVariables({key: 'value'}, {type: 'global'});

// ä½¿ç”¨Zodè¿›è¡Œæ•°æ®æ ¡éªŒ
const Settings = z.object({
  button_selected: z.boolean().default(false)
});
const settings = Settings.parse(getVariables({type: 'script', script_id: getScriptId()}));
```

---

## 7. å‰ç«¯ç•Œé¢å¼€å‘

### 7.1 é¡¹ç›®åˆ¤å®š

å¦‚æœ`src/xxx`æ–‡ä»¶å¤¹ä¸­æ—¢æœ‰`index.ts`æ–‡ä»¶ä¹Ÿæœ‰`index.html`æ–‡ä»¶ï¼Œåˆ™å®ƒæ˜¯å‰ç«¯ç•Œé¢é¡¹ç›®ã€‚

å‰ç«¯ç•Œé¢ä»¥æ— æ²™ç›’iframeçš„å½¢å¼åœ¨é…’é¦†æ¶ˆæ¯æ¥¼å±‚ä¸­å‰å°æ˜¾ç¤ºï¼Œæœ‰ä¸€ä¸ªè‡ªå·±çš„ç•Œé¢ã€‚

### 7.2 index.htmlè§„èŒƒ

å‰ç«¯ç•Œé¢çš„`index.html`ä»…å¯å¡«å†™é™æ€`<body>`å†…å®¹ï¼Œä¸å¾—å¼•ç”¨é¡¹ç›®ä¸­å…¶ä»–æ–‡ä»¶ï¼š

```html
<head>
  <!-- ä¿ç•™ç©ºç™½ï¼Œwebpackæ‰“åŒ…æ—¶ä¼šæ’å…¥æ ·å¼ã€è„šæœ¬ç­‰ -->
</head>
<body>
  <!-- è¿™é‡Œå†™<div>ã€<span>ç­‰é™æ€å†…å®¹ -->
  <!-- ä¹Ÿå¯ä»¥åªå†™<div id="app"></div>äº¤ç»™vueæ¸²æŸ“ -->
</body>
```

**ç¦æ­¢äº‹é¡¹:**
- âŒ ç¦æ­¢ä½¿ç”¨`<link>`å¯¼å…¥æ ·å¼
- âŒ ç¦æ­¢ä½¿ç”¨`<script>`å¼•ç”¨æœ¬åœ°è„šæœ¬
- âŒ ç¦æ­¢ä½¿ç”¨`<img src="">`å ä½

### 7.3 æ ·å¼è§„èŒƒ

**ç®€å•æ ·å¼:**
- å¯åœ¨index.htmlä¸­ç›´æ¥ä½¿ç”¨TailwindCSS
- éœ€è¦æ–°å»º`@import 'tailwindcss'`çš„CSSæ–‡ä»¶å¹¶å¯¼å…¥

**å¤æ‚æ ·å¼:**
- ä¼˜å…ˆä½¿ç”¨Vueç»„ä»¶çš„`<style lang="scss">`æ ‡ç­¾
- æˆ–åœ¨TypeScriptä¸­`import './index.scss'`

### 7.4 iframeé€‚é…è¦æ±‚

- âŒ ç¦æ­¢ä½¿ç”¨`vh`ç­‰å—å®¿ä¸»é«˜åº¦å½±å“çš„å•ä½
- âœ… ä½¿ç”¨`width`å’Œ`aspect-ratio`è®©é«˜åº¦åŠ¨æ€è°ƒæ•´
- âŒ é¿å…ä½¿ç”¨`min-height`ã€`overflow: auto`ç­‰å¼ºåˆ¶æ’‘é«˜çˆ¶å®¹å™¨çš„å…ƒç´ 
- âœ… é¡µé¢æ•´ä½“åº”é€‚é…å®¹å™¨å®½åº¦ï¼Œä¸äº§ç”Ÿæ¨ªå‘æ»šåŠ¨æ¡
- âœ… ä¼˜å…ˆå¡ç‰‡å½¢çŠ¶ï¼Œæ— èƒŒæ™¯é¢œè‰²ï¼ˆé™¤éæ˜ç¡®è¦æ±‚ï¼‰

### 7.5 æ­£ç¡®åŠ è½½/å¸è½½

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨jQueryåˆå§‹åŒ–
$(() => {
  toastr.success('ç•Œé¢åŠ è½½æˆåŠŸï¼');
  createApp(app).use(router).mount('#app');
});

// âœ… æ­£ç¡®ï¼šä½¿ç”¨jQueryå’Œpagehideäº‹ä»¶å¸è½½
$(window).on('pagehide', () => {
  toastr.info('ç•Œé¢å·²å¸è½½');
});

// âŒ é”™è¯¯ï¼šä½¿ç”¨DOMContentLoaded
document.addEventListener("DOMContentLoaded", fn);

// âŒ é”™è¯¯ï¼šåœ¨å…¨å±€ä½œç”¨åŸŸæ‰§è¡Œä»£ç 
toastr.success('è¿™ä¼šåœ¨æ¯æ¬¡å¯¼å…¥æ—¶æ‰§è¡Œ');
```

### 7.6 Vueå¼€å‘è§„èŒƒ

```typescript
// ä¼˜å…ˆä½¿ç”¨Vueç¼–å†™ç•Œé¢
// Vue Routerå¿…é¡»ä½¿ç”¨createMemoryHistory()
const router = createRouter({
  history: createMemoryHistory(),
  routes: [...]
});

// ç›‘å¬Vueå“åº”å¼æ•°æ®å˜åŒ–å¹¶åŒæ­¥åˆ°é…’é¦†æ•°æ®
watchEffect(() => {
  replaceVariables(klona(settings.value), {type: 'script', script_id: getScriptId()});
});

// çŠ¶æ€ç®¡ç†ä½¿ç”¨Pinia
const useSettingsStore = defineStore('settings', () => {
  const settings = ref(Settings.parse(getVariables({type: 'script', script_id: getScriptId()})));
  return {settings};
});
```

---

## 8. è„šæœ¬å¼€å‘

### 8.1 é¡¹ç›®åˆ¤å®š

å¦‚æœ`src/xxx`æ–‡ä»¶å¤¹ä¸­ä»…æœ‰`index.ts`æ–‡ä»¶ï¼Œåˆ™å®ƒæ˜¯è„šæœ¬é¡¹ç›®ã€‚

è„šæœ¬ä»¥æ— æ²™ç›’iframeçš„å½¢å¼åœ¨é…’é¦†åå°è¿è¡Œï¼Œæ²¡æœ‰è‡ªå·±çš„ç•Œé¢ï¼Œåªæœ‰ä»£ç éƒ¨åˆ†å¯ä¾›ç¼–å†™ã€‚

### 8.2 jQueryä½¿ç”¨

è„šæœ¬ä¸­çš„jQueryç›´æ¥ä½œç”¨äºæ•´ä¸ªé…’é¦†é¡µé¢è€Œéä»…ä½œç”¨äºè„šæœ¬æ‰€åœ¨çš„iframeï¼š

```typescript
// âœ… é€‰æ‹©é…’é¦†é¡µé¢çš„body
$('body')

// âŒ é€‰æ‹©è„šæœ¬iframeçš„body
$(document.body)
```

### 8.3 Vueç»„ä»¶æŒ‚è½½

å½“éœ€è¦åœ¨è„šæœ¬ä¸­å‘é…’é¦†é¡µé¢æŒ‚è½½Vueç»„ä»¶æ—¶ï¼š

```typescript
// ä½¿ç”¨jQueryåˆ›å»ºæŒ‚è½½ä½ç½®
const $app = $('<div id="app"></div>');
$('body').append($app);

// æŒ‚è½½Vueç»„ä»¶
app.mount($app[0]);
```

### 8.4 æ ·å¼å¤„ç†

ç”±äºè„šæœ¬è¿è¡Œåœ¨iframeä¸­ï¼Œæ ·å¼ä»…ä¼šåº”ç”¨äºiframeå†…ã€‚å‘é…’é¦†ç½‘é¡µæ·»åŠ DOMæ—¶ï¼Œéœ€è¦å°†æ ·å¼å¤åˆ¶åˆ°é…’é¦†ç½‘é¡µçš„`<head>`ä¸­ï¼š

```typescript
export function teleport_style() {
  $(`<div>`)
    .attr('script_id', getScriptId())
    .append($(`head > style`, document).clone())
    .appendTo('head');
}

export function deteleport_style() {
  $(`head > div[script_id="${getScriptId()}"]`).remove();
}
```

### 8.5 è„šæœ¬è®¾ç½®

ä½¿ç”¨è„šæœ¬å˜é‡å’ŒZodä¸ºç”¨æˆ·æä¾›è‡ªå®šä¹‰è®¾ç½®ï¼š

```typescript
const Settings = z.object({
  button_enabled: z.boolean().default(false),
  theme: z.enum(['light', 'dark']).default('light')
});

const settings = ref(Settings.parse(getVariables({type: 'script', script_id: getScriptId()})));
```

### 8.6 æŒ‰é’®åŠŸèƒ½

è„šæœ¬å¯ä»¥æ³¨å†ŒæŒ‰é’®äº‹ä»¶ï¼š

```typescript
eventOn(getButtonEvent('æŒ‰é’®å'), () => {
  console.log('æŒ‰é’®è¢«ç‚¹å‡»äº†');
});
```

---

## 9. MVUå˜é‡æ¡†æ¶

### 9.1 æ¦‚è¿°

MVUå˜é‡æ¡†æ¶æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é…’é¦†åŠ©æ‰‹è„šæœ¬ï¼Œä½œç”¨äºæ¶ˆæ¯æ¥¼å±‚å˜é‡ã€‚å®ƒå…è®¸ï¼š
- åœ¨ä¸–ç•Œä¹¦ä¸­è®¾ç½®æ¶ˆæ¯æ¥¼å±‚å˜é‡
- åœ¨ä¸–ç•Œä¹¦æˆ–èŠå¤©è®°å½•ä¸­åˆå§‹åŒ–æ¶ˆæ¯æ¥¼å±‚å˜é‡
- ç”¨AIè¾“å‡ºæ›´æ–°æ¶ˆæ¯æ¥¼å±‚å˜é‡

### 9.2 æ¥å£æ–‡ä»¶

MVUçš„æ¥å£å®šä¹‰åœ¨`@types/iframe/exported.mvu.d.ts`ä¸­ã€‚å½“æåŠ"MVUå˜é‡"æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨MVUå˜é‡æ¡†æ¶çš„æ¥å£ã€‚

### 9.3 ä½¿ç”¨æµç¨‹

```typescript
// 1. ç­‰å¾…åˆå§‹åŒ–
await waitGlobalInitialized('Mvu');

// 2. è¯»å–MVUæ•°æ®
const data = Mvu.getMvuData({type: 'message', message_id: 'latest'});

// 3. è‡ªè¡Œè§£æMVUå‘½ä»¤
const result = Mvu.parseMessage(oldVars, messageString);

// 4. å†™å›æ•°æ®
Mvu.replaceMvuData(newData, {type: 'message', message_id: 5});
```

### 9.4 æ•°æ®å­˜å‚¨

- MVUå°†å˜é‡æ•°æ®å­˜å‚¨åœ¨`_.get(æŸæ¥¼å±‚å˜é‡, 'stat_data')`ä¸­
- ç­‰ä»·æ“ä½œï¼š`_.get(getVariables({type: 'message', message_id: 5}), 'stat_data')` = `Mvu.getMvuData({type: 'message', message_id: 5})`
- é¢å¤–å­—æ®µï¼š`display_data`ï¼ˆå¯è§†åŒ–è¡¨ç¤ºï¼‰å’Œ`delta_data`ï¼ˆå˜é‡å˜åŒ–ï¼‰

### 9.5 äº‹ä»¶ç³»ç»Ÿ

MVUæä¾›äº‹ä»¶ç›‘å¬åŠŸèƒ½ï¼Œç”¨äºç›‘å¬å˜é‡å˜åŒ–ï¼š

```typescript
// ç›‘å¬å˜é‡å˜åŒ–äº‹ä»¶
Mvu.on('variableChanged', (data) => {
  // å¤„ç†å˜é‡å˜åŒ–
});
```

---

## 10. Chrome DevTools MCP

### 10.1 æ¦‚è¿°

Chrome DevTools MCPé€šè¿‡Model Context Protocol (MCP)ä¸ºAIåŠ©æ‰‹æä¾›å®Œæ•´çš„Chrome DevToolsåŠŸèƒ½è®¿é—®æƒé™ï¼Œæä¾›**6å¤§ç±»å…±26ä¸ªå·¥å…·åŠŸèƒ½**ã€‚

### 10.2 å·¥å…·åˆ†ç±»

#### 10.2.1 Input automation (8ä¸ªå·¥å…·) - è¾“å…¥è‡ªåŠ¨åŒ–

- `click` - ç‚¹å‡»æŒ‡å®šå…ƒç´ 
- `drag` - æ‹–æ‹½å…ƒç´ åˆ°ç›®æ ‡ä½ç½®
- `fill` - åœ¨è¾“å…¥æ¡†è¾“å…¥æ–‡æœ¬æˆ–é€‰æ‹©ä¸‹æ‹‰é€‰é¡¹
- `fill_form` - æ‰¹é‡å¡«å……å¤šä¸ªè¡¨å•å…ƒç´ 
- `handle_dialog` - å¤„ç†æµè§ˆå™¨å¼¹å‡ºçš„å¯¹è¯æ¡†
- `hover` - æ‚¬åœåœ¨æŒ‡å®šå…ƒç´ ä¸Š
- `press_key` - æŒ‰é”®æˆ–ç»„åˆé”®æ“ä½œ
- `upload_file` - é€šè¿‡å…ƒç´ ä¸Šä¼ æ–‡ä»¶

#### 10.2.2 Navigation automation (6ä¸ªå·¥å…·) - å¯¼èˆªè‡ªåŠ¨åŒ–

- `close_page` - å…³é—­æŒ‡å®šç´¢å¼•çš„é¡µé¢
- `list_pages` - è·å–æ‰€æœ‰æ‰“å¼€çš„é¡µé¢åˆ—è¡¨
- `navigate_page` - å¯¼èˆªåˆ°URLæˆ–å†å²æ“ä½œ
- `new_page` - åˆ›å»ºæ–°é¡µé¢
- `select_page` - é€‰æ‹©é¡µé¢ä½œä¸ºä¸Šä¸‹æ–‡
- `wait_for` - ç­‰å¾…æŒ‡å®šæ–‡æœ¬åœ¨é¡µé¢ä¸Šå‡ºç°

#### 10.2.3 Emulation (2ä¸ªå·¥å…·) - æ¨¡æ‹Ÿ

- `emulate` - æ¨¡æ‹ŸCPUå’Œç½‘ç»œæ¡ä»¶
- `resize_page` - è°ƒæ•´é¡µé¢çª—å£å¤§å°

#### 10.2.4 Performance (3ä¸ªå·¥å…·) - æ€§èƒ½åˆ†æ

- `performance_analyze_insight` - åˆ†ææ€§èƒ½è·Ÿè¸ªä¸­çš„ç‰¹å®šæ´å¯Ÿ
- `performance_start_trace` - å¼€å§‹æ€§èƒ½è·Ÿè¸ªè®°å½•
- `performance_stop_trace` - åœæ­¢æ€§èƒ½è·Ÿè¸ªè®°å½•

#### 10.2.5 Network (2ä¸ªå·¥å…·) - ç½‘ç»œè¯·æ±‚

- `get_network_request` - è·å–æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚
- `list_network_requests` - åˆ—å‡ºæ‰€æœ‰ç½‘ç»œè¯·æ±‚

#### 10.2.6 Debugging (5ä¸ªå·¥å…·) - è°ƒè¯•

- `evaluate_script` - åœ¨å½“å‰é¡µé¢æ‰§è¡ŒJavaScriptå‡½æ•°
- `get_console_message` - æ ¹æ®IDè·å–æ§åˆ¶å°æ¶ˆæ¯
- `list_console_messages` - åˆ—å‡ºæ‰€æœ‰æ§åˆ¶å°æ¶ˆæ¯
- `take_screenshot` - æˆªå–é¡µé¢æˆ–å…ƒç´ æˆªå›¾
- `take_snapshot` - è·å–é¡µé¢çš„æ–‡æœ¬å¿«ç…§ï¼ˆåŸºäºæ— éšœç¢æ ‘ï¼‰

### 10.3 å…¸å‹å·¥ä½œæµç¨‹

```typescript
// 1. è·å–é¡µé¢å¿«ç…§ï¼ˆè·å–å…ƒç´ uidï¼‰
take_snapshot({ verbose: true });

// 2. å¯¼èˆªåˆ°æŒ‡å®šURL
navigate_page({ type: 'url', url: 'https://example.com' });

// 3. ç­‰å¾…é¡µé¢åŠ è½½
wait_for({ text: 'æ¬¢è¿', timeout: 5000 });

// 4. å¡«å……è¡¨å•
fill_form({
  elements: [
    { uid: 'element-1', value: 'ç”¨æˆ·å' },
    { uid: 'element-2', value: 'å¯†ç ' }
  ]
});

// 5. ç‚¹å‡»æäº¤æŒ‰é’®
click({ uid: 'submit-button' });

// 6. æˆªå–ç»“æœæˆªå›¾
take_screenshot({ format: 'png', fullPage: true });
```

### 10.4 æ€§èƒ½åˆ†æå·¥ä½œæµç¨‹

```typescript
// 1. å¼€å§‹æ€§èƒ½è·Ÿè¸ª
performance_start_trace({ autoStop: true, reload: true });

// ç­‰å¾…è·Ÿè¸ªå®Œæˆ...

// 2. åˆ†ææ€§èƒ½æ´å¯Ÿ
performance_analyze_insight({
  insightSetId: 'insight-set-1',
  insightName: 'LCPBreakdown'
});

// 3. åœæ­¢è·Ÿè¸ª
performance_stop_trace();
```

---

## 11. å‰ç«¯ç¾åŒ–è®¾è®¡æŠ€èƒ½ç³»ç»Ÿ

### 11.1 æ¦‚è¿°

å‰ç«¯ç¾åŒ–è®¾è®¡æŠ€èƒ½ç³»ç»Ÿï¼ˆUI Skills Systemï¼‰æ˜¯ä¸“ä¸ºé…’é¦†åŠ©æ‰‹é¡¹ç›®æ‰“é€ çš„å‰ç«¯ç•Œé¢ç»„ä»¶åº“å’Œå¼€å‘å·¥å…·é›†ã€‚å®ƒæä¾›äº†ä¸€æ•´å¥—å®Œæ•´çš„UIç»„ä»¶ã€åŠ¨ç”»æ•ˆæœã€è®¾è®¡ç³»ç»Ÿå’Œå¼€å‘æ¨¡æ¿ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿæ„å»ºç¾è§‚ã€ä¸€è‡´çš„ç”¨æˆ·ç•Œé¢ã€‚

### 11.2 æ ¸å¿ƒç‰¹æ€§

- **ğŸ¨ å®Œæ•´ç»„ä»¶åº“**: 13+ é«˜è´¨é‡Vue 3ç»„ä»¶ï¼Œæ¶µç›–å¸¸ç”¨UIæ¨¡å¼
- **ğŸ¬ åŠ¨ç”»å·¥å…·**: åŸºäºGSAPçš„æµç•…åŠ¨ç”»æ•ˆæœåº“
- **ğŸ“ è®¾è®¡ç³»ç»Ÿ**: ç»Ÿä¸€çš„è®¾è®¡Tokenså’Œæ ·å¼å·¥å…·
- **ğŸ“¦ é¡µé¢æ¨¡æ¿**: å¼€ç®±å³ç”¨çš„å®Œæ•´é¡µé¢æ¨¡æ¿
- **âš¡ TypeScript**: å®Œæ•´ç±»å‹å®šä¹‰ï¼Œä¼˜ç§€çš„å¼€å‘ä½“éªŒ
- **ğŸ“± å“åº”å¼**: ç§»åŠ¨ç«¯ä¼˜å…ˆçš„å“åº”å¼è®¾è®¡
- **ğŸ¯ é…’é¦†ä¸“ç”¨**: é’ˆå¯¹é…’é¦†åŠ©æ‰‹åœºæ™¯ä¼˜åŒ–

### 11.3 ç›®å½•ç»“æ„

```
UI/
â”œâ”€â”€ components/          # UIç»„ä»¶åº“
â”‚   â”œâ”€â”€ index.ts        # ç»„ä»¶å¯¼å‡ºå…¥å£
â”‚   â”œâ”€â”€ UiCard.vue      # åŸºç¡€å¡ç‰‡
â”‚   â”œâ”€â”€ UiButton.vue    # æŒ‰é’®ç»„ä»¶
â”‚   â”œâ”€â”€ UiSearchBar.vue # æœç´¢æ 
â”‚   â”œâ”€â”€ UiGrid.vue      # ç½‘æ ¼å¸ƒå±€
â”‚   â”œâ”€â”€ UiHeader.vue    # é¡µé¢å¤´éƒ¨
â”‚   â”œâ”€â”€ UiBadge.vue     # å¾½ç« /æ ‡ç­¾
â”‚   â”œâ”€â”€ UiStarRating.vue# æ˜Ÿçº§è¯„åˆ†
â”‚   â”œâ”€â”€ UiTab.vue       # æ ‡ç­¾é¡µ
â”‚   â”œâ”€â”€ UiInfoCard.vue  # ä¿¡æ¯å¡ç‰‡
â”‚   â”œâ”€â”€ UiPackageCard.vue # å¥—é¤å¡ç‰‡
â”‚   â”œâ”€â”€ UiStatusPanel.vue # çŠ¶æ€é¢æ¿
â”‚   â”œâ”€â”€ UiProfileHeader.vue # ä¸ªäººèµ„æ–™å¤´
â”‚   â””â”€â”€ UiListSection.vue # åˆ—è¡¨åŒºå—
â”‚
â”œâ”€â”€ animations/         # åŠ¨ç”»å·¥å…·åº“
â”‚   â””â”€â”€ index.ts        # åŠ¨ç”»å‡½æ•°é›†åˆ
â”‚
â”œâ”€â”€ styles/             # æ ·å¼ç³»ç»Ÿ
â”‚   â”œâ”€â”€ tokens.scss     # è®¾è®¡Tokens
â”‚   â””â”€â”€ mixins.scss     # æ ·å¼Mixins
â”‚
â”œâ”€â”€ templates/          # é¡µé¢æ¨¡æ¿
â”‚   â”œâ”€â”€ HomePage.vue
â”‚   â”œâ”€â”€ ServiceStatusPage.vue
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ examples/           # ä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ BasicUsage.vue
â”‚   â””â”€â”€ AdvancedUsage.vue
â”‚
â”œâ”€â”€ docs/              # æ–‡æ¡£
â”‚   â”œâ”€â”€ components.md
â”‚   â”œâ”€â”€ animations.md
â”‚   â”œâ”€â”€ best-practices.md
â”‚   â””â”€â”€ integration.md
â”‚
â””â”€â”€ index.ts           # ä¸»å…¥å£æ–‡ä»¶
```

### 11.4 ç»„ä»¶åº“è¯´æ˜

#### 11.4.1 åŸºç¡€ç»„ä»¶

**UiCard - åŸºç¡€å¡ç‰‡å®¹å™¨**
- æ”¯æŒæ‚¬åœæ•ˆæœ (`hoverable`)
- æ”¯æŒç‚¹å‡»åé¦ˆ (`clickable`)
- æ”¯æŒé€‰ä¸­çŠ¶æ€ (`selected`)

**UiButton - æŒ‰é’®ç»„ä»¶**
- 4ç§æ ·å¼å˜ä½“ï¼šfilledã€outlineã€ghostã€link
- 3ç§å°ºå¯¸ï¼šsmã€mdã€lg
- æ”¯æŒåŠ è½½çŠ¶æ€å’Œå›¾æ ‡

**UiSearchBar - æœç´¢æ **
- å†…ç½®æœç´¢å›¾æ ‡
- æ”¯æŒå›è½¦æœç´¢å’ŒæŒ‰é’®æœç´¢
- å¯è‡ªå®šä¹‰æŒ‰é’®æ–‡æœ¬

**UiGrid - ç½‘æ ¼å¸ƒå±€**
- è‡ªå®šä¹‰åˆ—æ•°ï¼ˆ1-4åˆ—ï¼‰
- å“åº”å¼é€‚é…ï¼ˆè‡ªåŠ¨è°ƒæ•´ï¼‰
- 3ç§é—´è·è§„æ ¼

#### 11.4.2 å¤åˆç»„ä»¶

**UiHeader - é¡µé¢å¤´éƒ¨**
- å›¾æ ‡ã€æ ‡é¢˜ã€å‰¯æ ‡é¢˜
- å³ä¾§æ“ä½œåŒºæ’æ§½
- ç»Ÿä¸€çš„é¡µé¢å¤´éƒ¨æ ·å¼

**UiBadge - å¾½ç« /æ ‡ç­¾**
- 9ç§é¢œè‰²å˜ä½“ï¼ˆprimaryã€successã€warningã€dangerã€infoã€hotã€newã€recommendã€vipï¼‰
- 3ç§å°ºå¯¸
- æ”¯æŒç‚¹å’Œå›¾æ ‡æ¨¡å¼

**UiStarRating - æ˜Ÿçº§è¯„åˆ†**
- å¯äº¤äº’è¯„åˆ†
- è‡ªå®šä¹‰æœ€å¤§æ˜Ÿæ•°
- æ‚¬åœæ•ˆæœå’Œæ–‡æœ¬æ˜¾ç¤º

**UiTab - æ ‡ç­¾é¡µ**
- å¹³æ»‘åˆ‡æ¢åŠ¨ç”»
- å“åº”å¼æ°´å¹³æ»šåŠ¨
- æ ‡ç­¾åˆ‡æ¢äº‹ä»¶

#### 11.4.3 ä¸šåŠ¡ç»„ä»¶

**UiInfoCard - ä¿¡æ¯å¡ç‰‡**
- å›¾æ ‡+æ ‡ç­¾+æ•°å€¼å¸ƒå±€
- 5ç§å›¾æ ‡é¢œè‰²
- æ’æ§½æ”¯æŒè‡ªå®šä¹‰å†…å®¹

**UiPackageCard - å¥—é¤å¡ç‰‡**
- å¤´åƒåŒºåŸŸ
- åç§°å’Œæè¿°
- æ ‡ç­¾åˆ—è¡¨å±•ç¤º

**UiStatusPanel - çŠ¶æ€é¢æ¿**
- å¡ç‰‡å®¹å™¨
- è‡ªå®šä¹‰å¤´éƒ¨
- é€‚åˆçŠ¶æ€å±•ç¤ºé¡µé¢

**UiProfileHeader - ä¸ªäººèµ„æ–™å¤´**
- å¤´åƒã€åç§°ã€å‰¯æ ‡é¢˜
- èƒŒæ™¯æ¸å˜æ•ˆæœ
- å¾½ç« æ’æ§½

**UiListSection - åˆ—è¡¨åŒºå—**
- æ ‡é¢˜å’Œæ“ä½œåŒº
- å†…å®¹åŒºåŸŸæ’æ§½
- åˆ—è¡¨ç»„ç»‡å•å…ƒ

### 11.5 åŠ¨ç”»å·¥å…·åº“

#### 11.5.1 é¡µé¢åŠ¨ç”» (pageAnimations)

```typescript
// æ·¡å…¥åŠ¨ç”»
pageAnimations.fadeIn('.element', 0.6);

// æ»‘å…¥åŠ¨ç”»ï¼ˆ4ä¸ªæ–¹å‘ï¼‰
pageAnimations.slideIn('.element', 'up', 0.5);

// å¼¹è·³è¿›å…¥
pageAnimations.bounceIn('.element', 0.8);

// ç¼©æ”¾å‡ºç°
pageAnimations.scaleIn('.element', 0.4);

// æ—‹è½¬è¿›å…¥
pageAnimations.rotateIn('.element', 0.6);
```

#### 11.5.2 äº¤äº’åŠ¨ç”» (interactionAnimations)

```typescript
// æ‚¬åœæ”¾å¤§
interactionAnimations.hoverScale('.element', 1.05);

// æŒ‰é’®ç‚¹å‡»åé¦ˆ
interactionAnimations.buttonClick('.button');

// å¡ç‰‡æ‚¬åœæ•ˆæœ
interactionAnimations.cardHover('.card');

// åŠ è½½åŠ¨ç”»
interactionAnimations.loadingSpinner('.spinner');
```

#### 11.5.3 åˆ—è¡¨åŠ¨ç”» (listAnimations)

```typescript
// åˆ—è¡¨é¡¹ä¾æ¬¡è¿›å…¥
listAnimations.staggerIn('.item', 0.1);

// ç€‘å¸ƒæµåŠ è½½
listAnimations.waterfall('.grid-item', 0.05);
```

#### 11.5.4 è¿›åº¦åŠ¨ç”» (progressAnimations)

```typescript
// æ•°å­—é€’å¢
progressAnimations.counter('.counter', 100, 2);

// è¿›åº¦æ¡å¡«å……
progressAnimations.progressFill('.progress', 80, 1.5);
```

### 11.6 è®¾è®¡ç³»ç»Ÿ

#### 11.6.1 è®¾è®¡Tokens

```scss
// é¢œè‰²ç³»ç»Ÿ
color(primary)      // #4f46e5
color(success)      // #10b981
color(warning)      // #f59e0b

// æ–‡æœ¬é¢œè‰²
text-color(primary)      // ä¸»æ–‡æœ¬
text-color(secondary)    // æ¬¡è¦æ–‡æœ¬
text-color(disabled)     // ç¦ç”¨æ–‡æœ¬

// é—´è·ç³»ç»Ÿ
spacing(4)   // 16px
spacing(6)   // 24px
spacing(8)   // 32px

// å­—ä½“ç³»ç»Ÿ
font(base)   // 16px
font(lg)     // 18px
font(xl)     // 20px

font(bold)   // 700
font(medium) // 500
```

#### 11.6.2 æ ·å¼Mixins

```scss
// Flexboxå±…ä¸­
@include flex-center();

// å¡ç‰‡æ ·å¼
@include card-base();

// æŒ‰é’®æ ·å¼
@include button-filled();

// æ‚¬åœé˜´å½±
@include hover-shadow();

// å“åº”å¼æ–­ç‚¹
@include up(md) { /* å¤§å±å¹•æ ·å¼ */ }
@include down(sm) { /* å°å±å¹•æ ·å¼ */ }
```

### 11.7 ä½¿ç”¨ç¤ºä¾‹

#### 11.7.1 åŸºç¡€ç”¨æ³•

```vue
<template>
  <UiCard hoverable clickable @click="handleClick">
    <h3>å¡ç‰‡æ ‡é¢˜</h3>
    <p>å¡ç‰‡å†…å®¹</p>
  </UiCard>

  <UiButton variant="outline" icon="heart">
    æŒ‰é’®
  </UiButton>

  <UiSearchBar
    v-model="keyword"
    placeholder="è¾“å…¥å…³é”®è¯..."
    @search="handleSearch"
  />
</template>

<script setup lang="ts">
import { UiCard, UiButton, UiSearchBar } from '@UI/components';

const keyword = ref('');

const handleClick = () => {
  console.log('å¡ç‰‡è¢«ç‚¹å‡»');
};

const handleSearch = (value: string) => {
  console.log('æœç´¢:', value);
};
</script>
```

#### 11.7.2 å¤æ‚å¸ƒå±€

```vue
<template>
  <UiHeader title="ç”¨æˆ·ç®¡ç†" icon="users">
    <template #actions>
      <UiButton variant="filled" size="sm">æ·»åŠ ç”¨æˆ·</UiButton>
    </template>
  </UiHeader>

  <UiListSection title="ç”¨æˆ·åˆ—è¡¨">
    <UiGrid :columns="3" gap="md">
      <UiCard
        v-for="user in users"
        :key="user.id"
        clickable
        hoverable
        @click="handleUserClick(user)"
      >
        <UiProfileHeader
          :name="user.name"
          :subtitle="user.email"
          :avatar="user.avatar"
        >
          <template #badges>
            <UiBadge v-if="user.admin" variant="vip">ç®¡ç†å‘˜</UiBadge>
          </template>
        </UiProfileHeader>
      </UiCard>
    </UiGrid>
  </UiListSection>
</template>

<script setup lang="ts">
import {
  UiHeader,
  UiListSection,
  UiGrid,
  UiCard,
  UiProfileHeader,
  UiBadge,
  UiButton,
} from '@UI/components';
</script>
```

#### 11.7.3 åŠ¨ç”»åº”ç”¨

```vue
<script setup lang="ts">
import { pageAnimations, listAnimations } from '@UI/animations';
import { onMounted, nextTick } from 'vue';

onMounted(async () => {
  await nextTick();

  // é¡µé¢åŠ è½½åŠ¨ç”»
  pageAnimations.fadeIn('.page-content', 0.6);

  // åˆ—è¡¨åŠ¨ç”»
  listAnimations.staggerIn('.list-item', 0.1);
});
</script>
```

### 11.8 é¡µé¢æ¨¡æ¿

#### 11.8.1 é¦–é¡µæ¨¡æ¿ (HomePage.vue)

å®Œæ•´çš„é¦–é¡µå¸ƒå±€ï¼ŒåŒ…å«ï¼š
- é¡µé¢å¤´éƒ¨
- åˆ†ç±»ç½‘æ ¼
- æœç´¢æ 
- ç‰¹è‰²ç©æ³•åŒºåŸŸ
- æ¨èåˆ—è¡¨

#### 11.8.2 æœåŠ¡çŠ¶æ€é¡µé¢ (ServiceStatusPage.vue)

å®Œæ•´çš„æœåŠ¡çŠ¶æ€å±•ç¤ºé¡µé¢ï¼ŒåŒ…å«ï¼š
- åŸºç¡€ä¿¡æ¯å¡ç‰‡ç½‘æ ¼
- æ ‡ç­¾é¡µåˆ‡æ¢
- çŠ¶æ€è¯¦æƒ…é¢æ¿
- æ˜Ÿçº§è¯„åˆ†
- è¿›åº¦æ¡å±•ç¤º
- æ“ä½œæŒ‰é’®

### 11.9 æœ€ä½³å®è·µ

1. **ç»„ä»¶é€‰æ‹©**: æ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç»„ä»¶
2. **æ ·å¼ç®¡ç†**: ä½¿ç”¨è®¾è®¡Tokenså’ŒMixins
3. **å“åº”å¼**: ç§»åŠ¨ç«¯ä¼˜å…ˆçš„è®¾è®¡æ€è·¯
4. **åŠ¨ç”»ä¼˜åŒ–**: åˆç†æ§åˆ¶åŠ¨ç”»æ—¶é•¿å’Œæ•°é‡
5. **å¯è®¿é—®æ€§**: æä¾›é”®ç›˜å¯¼èˆªå’ŒARIAæ ‡ç­¾

### 11.10 é›†æˆæŒ‡å—

1. **æ–‡ä»¶å¤åˆ¶**: å°†`UI/`ç›®å½•å¤åˆ¶åˆ°é¡¹ç›®æ ¹ç›®å½•
2. **é…ç½®åˆ«å**: åœ¨`tsconfig.json`ä¸­é…ç½®`@UI`è·¯å¾„åˆ«å
3. **å¯¼å…¥ä½¿ç”¨**: åœ¨ç»„ä»¶ä¸­å¯¼å…¥éœ€è¦çš„ç»„ä»¶
4. **å¯¼å…¥æ ·å¼**: åœ¨æ ·å¼æ–‡ä»¶ä¸­å¯¼å…¥è®¾è®¡Tokens
5. **ä½¿ç”¨åŠ¨ç”»**: åœ¨é€‚å½“çš„ä½ç½®è°ƒç”¨åŠ¨ç”»å‡½æ•°

è¯¦ç»†é›†æˆæ­¥éª¤è¯·å‚è€ƒï¼š`UI/docs/integration.md`

### 11.11 æ–‡æ¡£èµ„æº

- **README** (`UI/README.md`) - æ¦‚è§ˆå’Œå¿«é€Ÿå¼€å§‹
- **ç»„ä»¶æ–‡æ¡£** (`UI/docs/components.md`) - è¯¦ç»†çš„ç»„ä»¶API
- **åŠ¨ç”»æŒ‡å—** (`UI/docs/animations.md`) - åŠ¨ç”»ä½¿ç”¨è¯´æ˜
- **æœ€ä½³å®è·µ** (`UI/docs/best-practices.md`) - å¼€å‘è§„èŒƒå’ŒæŠ€å·§
- **é›†æˆæŒ‡å—** (`UI/docs/integration.md`) - å®Œæ•´é›†æˆæ­¥éª¤

---

## 12. æœ€ä½³å®è·µ

### 11.1 ä»£ç è§„èŒƒ

**ä¼˜å…ˆä½¿ç”¨TypeScriptè€ŒéJavaScript**
- âœ… ä½¿ç”¨TypeScriptæä¾›æ›´å¥½çš„ç±»å‹æ£€æŸ¥
- âœ… åˆ©ç”¨æ¥å£å®šä¹‰å’Œç±»å‹æ¨æ–­
- âŒ é¿å…ä½¿ç”¨anyç±»å‹

**ä¼˜å…ˆä½¿ç”¨é…’é¦†åŠ©æ‰‹æä¾›çš„æ¥å£**
- âœ… ä½¿ç”¨`getChatMessages()`è€Œé`SillyTavern.chat`
- âœ… ä½¿ç”¨`replaceWorldbook()`è€Œé`triggerSlash('/setentryfield')`
- âœ… é…’é¦†åŠ©æ‰‹æ¥å£æŠ½è±¡å±‚æ¬¡æ›´é«˜ï¼Œæ›´ç¬¦åˆTypeScriptç±»å‹ç³»ç»Ÿ

### 11.2 æ•°æ®ç®¡ç†

**ä½¿ç”¨Pinia + Zodç®¡ç†çŠ¶æ€**

```typescript
// ç”¨Zodå®šä¹‰ç±»å‹å’Œé»˜è®¤å€¼
const Settings = z.object({
  button_selected: z.boolean().default(false)
}).preparse({});

// ä½¿ç”¨Piniaå®ç°å“åº”å¼è¯»å†™
export const useSettingsStore = defineStore('settings', () => {
  const settings = ref(Settings.parse(getVariables({type: 'script', script_id: getScriptId()})));

  watchEffect(() => {
    replaceVariables(klona(settings.value), {type: 'script', script_id: getScriptId()});
  });

  return { settings };
});
```

**å»é™¤Proxyå±‚**

```typescript
// å½“éœ€è¦ç›‘å¬Vueå“åº”å¼æ•°æ®å˜åŒ–å¹¶å­˜å…¥é…’é¦†æ•°æ®æ—¶
watchEffect(() => {
  replaceVariables(klona(settings.value), {type: 'script', script_id: getScriptId()});
});
```

### 11.3 ç•Œé¢å¼€å‘

**ä¼˜å…ˆä½¿ç”¨Vueç¼–å†™ç•Œé¢**
- âœ… Vueæ¯”jQueryæˆ–DOMæ“ä½œæ›´ç®€å•
- âœ… å¯ä½¿ç”¨Piniaã€VueRouterå’Œå…¶ä»–ç¬¬ä¸‰æ–¹åº“
- âŒ Vue Routerçš„createRouter()ä¸èƒ½å†™åœ¨`$(() => {})`ä¸­ï¼Œå¿…é¡»åœ¨å…¨å±€æ‰§è¡Œ

**Vue Routeré…ç½®**

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨createMemoryHistory()
const router = createRouter({
  history: createMemoryHistory(),
  routes: [...]
});
```

**å¤šåª’ä½“èµ„æºå¤„ç†**

```typescript
// å½“æœ‰å¾ˆå¤šå¤šåª’ä½“èµ„æºæ—¶ï¼Œä½¿ç”¨@pixi/reactåœ¨.tsxä¸­ç¼–å†™ç•Œé¢
// ä½¿ç”¨pixi.jså®ç°èµ„æºé¢„å…ˆåŠ è½½
```

### 11.4 é‡è½½æœºåˆ¶

```typescript
// å®Œå…¨é‡è½½å‰ç«¯ç•Œé¢æˆ–è„šæœ¬
let chat_id = SillyTavern.getCurrentChatId();
eventOn(tavern_events.CHAT_CHANGED, new_chat_id => {
  if (chat_id !== new_chat_id) {
    chat_id = new_chat_id;
    window.location.reload(); // âœ… ä½¿ç”¨window.location.reload()
  }
});
```

### 11.5 @pixi/reactä½¿ç”¨åœºæ™¯

```typescript
// å½“æœ‰å¾ˆå¤šå¤šåª’ä½“èµ„æºæ—¶ï¼Œå‰ç«¯ç•Œé¢æ›´åƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„æ¸¸æˆ
// åº”è¯¥ä½¿ç”¨@pixi/reactåœ¨.tsxä¸­ç¼–å†™ç•Œé¢
// å¹¶ä½¿ç”¨pixi.jså®ç°èµ„æºé¢„å…ˆåŠ è½½ç­‰é€»è¾‘
```

### 11.6 åŠ è½½/å¸è½½æ—¶æœº

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨jQueryåœ¨åŠ è½½æ—¶æ‰§è¡Œ
$(() => {
  // åœ¨è¿™é‡Œåˆå§‹åŒ–ç•Œé¢
});

// âœ… æ­£ç¡®ï¼šä½¿ç”¨jQueryå’Œpagehideäº‹ä»¶åœ¨å¸è½½æ—¶æ‰§è¡Œ
$(window).on('pagehide', () => {
  // åœ¨è¿™é‡Œæ¸…ç†èµ„æº
});

// âŒ é”™è¯¯ï¼šä½¿ç”¨DOMContentLoaded
document.addEventListener("DOMContentLoaded", fn);

// âŒ é”™è¯¯ï¼šåœ¨å…¨å±€ä½œç”¨åŸŸæ‰§è¡Œä»£ç 
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£

- [é…’é¦†åŠ©æ‰‹ä»‹ç»](https://n0vi028.github.io/JS-Slash-Runner-Doc/guide/å…³äºé…’é¦†åŠ©æ‰‹/ä»‹ç».html)
- [MVUå˜é‡æ¡†æ¶](https://github.com/MagicalAstrogy/MagVarUpdate)
- [Chrome DevToolså®˜æ–¹æ–‡æ¡£](https://developer.chrome.com/docs/devtools/)
- [Puppeteeræ–‡æ¡£](https://puppeteer.github.io/puppeteer/)
- [MCPåè®®è§„èŒƒ](https://modelcontextprotocol.io/)

### é¡¹ç›®æ–‡ä»¶

- `/src/APP/` - å®é™…é¡¹ç›®ç¤ºä¾‹
- `/src/ç•Œé¢ç¤ºä¾‹/` - å‰ç«¯ç•Œé¢æ¨¡æ¿
- `/src/è„šæœ¬ç¤ºä¾‹/` - è„šæœ¬é¡¹ç›®æ¨¡æ¿
- `/æ¨¡æ¿/**/æ–°å»ºä¸ºsrcæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å¤¹` - é¡¹ç›®æ¨¡æ¿
- `/@types/` - é…’é¦†åŠ©æ‰‹å’Œé…’é¦†APIç±»å‹å®šä¹‰
- `/slash_command.txt` - STScriptå‘½ä»¤åˆ—è¡¨

### å…³é”®é…ç½®æ–‡ä»¶

- `/webpack.config.ts` - **ä¸å…è®¸ä¿®æ”¹**
- `/package.json` - ä¾èµ–ç®¡ç†
- `/pnpm-lock.yaml` - é”å®šç‰ˆæœ¬

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

1. **ç¦æ­¢ä¿®æ”¹webpack.config.ts** - æ„å»ºé…ç½®æ–‡ä»¶å·²ä¼˜åŒ–ï¼Œä¿®æ”¹å¯èƒ½å¯¼è‡´æ„å»ºå¤±è´¥
2. **ç¦æ­¢è¶…å‡º@typesæ¥å£** - æ‰€æœ‰å¼€å‘å¿…é¡»ä½¿ç”¨@typesä¸­å®šä¹‰çš„æ¥å£
3. **æ­£ç¡®ä½¿ç”¨åŠ è½½/å¸è½½æ—¶æœº** - ä½¿ç”¨jQueryè€ŒéDOMContentLoaded
4. **Vue Routerå¿…é¡»ä½¿ç”¨MemoryHistory** - å‰ç«¯ç•Œé¢å’Œè„šæœ¬éƒ½æ˜¯iframe
5. **æ ·å¼éš”ç¦»å¤„ç†** - è„šæœ¬å‘é…’é¦†æ·»åŠ DOMæ—¶éœ€ç‰¹æ®Šå¤„ç†æ ·å¼
6. **å®‰å…¨è­¦å‘Š** - Chromeè°ƒè¯•ç«¯å£æ‰“å¼€æ—¶é¿å…æµè§ˆæ•æ„Ÿç½‘ç«™

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-15
**ç»´æŠ¤è€…**: é…’é¦†åŠ©æ‰‹å¼€å‘å›¢é˜Ÿ

---

> ğŸ’¡ **æç¤º**: æœ¬æ–‡æ¡£ä¸ºAIåŠ©æ‰‹ä¸“ç”¨å¼€å‘è§„èŒƒï¼Œéµå¾ªæ­¤è§„èŒƒå¯ä»¥ç¡®ä¿ä¸é…’é¦†åŠ©æ‰‹çš„å®Œç¾å…¼å®¹æ€§å’Œæœ€ä½³æ€§èƒ½è¡¨ç°ã€‚